<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>muuri demo</title>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="styles/style.css">
  </head>
  <body>
    <div class="controls">
      <div class="group">
        <button id="init">Init</button>
        <button id="destroy">Destroy</button>
      </div>
      <div class="group">
      <button id="show">Show</button>
      <button id="hide">Hide</button>
      </div>
      <div class="group">
        <button id="add">Add</button>
        <button id="remove">Remove</button>
      </div>
      <div class="group">
        <button id="layout">Layout</button>
        <button id="refresh">Refresh</button>
        <button id="sync-elements">Sync Elements</button>
      </div>
    </div>
    <div class="grid">
      <div class="item"><div class="item-content"><div class="item-stuff">A</div></div></div>
      <div class="item w2"><div class="item-content"><div class="item-stuff">B</div></div></div>
      <div class="item h2"><div class="item-content"><div class="item-stuff">C</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">D</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">E</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">F</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">G</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">H</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">I</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">J</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">K</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">L</div></div></div>
      <div class="item h2"><div class="item-content"><div class="item-stuff">M</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">N</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">O</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">P</div></div></div>
      <div class="item h2 w2"><div class="item-content"><div class="item-stuff">Q</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">R</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">S</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">T</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">U</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">V</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">W</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">X</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">Y</div></div></div>
      <div class="item"><div class="item-content"><div class="item-stuff">Z</div></div></div>
    </div>
    <script src="scripts/jquery.js"></script>
    <script src="scripts/lodash.js"></script>
    <script src="scripts/mezr.js"></script>
    <script src="scripts/jvent.js"></script>
    <script src="scripts/velocity.js"></script>
    <script src="scripts/hammer.js"></script>
    <script src="scripts/random-color.js"></script>
    <script src="../muuri.js"></script>
    <script>

      var grid;

      function generateAlphabet() {

        var possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        return possible.charAt(Math.floor(Math.random() * possible.length));

      }

      function generateElements(amount) {

        var ret = [];

        for (var i = 0, len = amount || 1; i < amount; i++) {

          var stuffDiv = document.createElement('div');
          stuffDiv.setAttribute('class', 'item-stuff');
          stuffDiv.appendChild(document.createTextNode(generateAlphabet()));
          stuffDiv.style.backgroundColor = randomColor();

          var innerDiv = document.createElement('div');
          innerDiv.setAttribute('class', 'item-content');

          var outerDiv = document.createElement('div');
          var width = Math.floor(Math.random() * 2) + 1;
          var height = Math.floor(Math.random() * 2) + 1;
          outerDiv.setAttribute('class', 'item h' + height + ' w' + width);
          outerDiv.appendChild(innerDiv.appendChild(stuffDiv));

          ret.push(outerDiv);

        }

        return ret;

      }

      function init() {

        if (grid) {
          grid.destroy();
        }

        // Colorize tiles.
        $('.item-stuff').each(function () {
          $(this).css('background-color', randomColor());
        });

        grid = new Muuri({
          container: document.getElementsByClassName('grid')[0],
          items: document.getElementsByClassName('item')
        });

      }

      function destroy() {

        grid.destroy();
        grid = null;

      }

      function show() {

        var items = _(grid.getItems()).filter(function (item) {
          return !item.isActive;
        }).sample(5).value();

        grid.show(items, function () {
          console.log('CALLBACK: Show ' + items.length + ' items');
        });

        layout();

      }

      function hide() {

        var items = _(grid.getItems()).filter(function (item) {
          return item.isActive;
        }).sample(5).value();

        grid.hide(items, function () {
          console.log('CALLBACK: Hide ' + items.length + ' items');
        });

        layout();

      }

      function add() {

        var items = generateElements(5);

        $(grid.element).append(items);

        grid.add(items, 0, function () {
          console.log('CALLBACK: Add ' + items.length + ' items');
        });

        layout();

      }

      function remove() {

        var items = _(grid.getItems()).filter(function (item) {
          return item.isActive;
        }).sample(5).value();

        grid.remove(items, function () {
          console.log('CALLBACK: Remove ' + items.length + ' items');
        });

        layout();

      }

      function layout() {

        grid.layout(function () {
          console.log('CALLBACK: Layout');
        });

      }

      function refresh() {

        grid.refresh();

      }

      function syncElements() {

        grid.syncElements();

      }

      $('#init').on('click', init);
      $('#destroy').on('click', destroy);
      $('#show').on('click', show);
      $('#hide').on('click', hide);
      $('#add').on('click', add);
      $('#remove').on('click', remove);
      $('#refresh').on('click', refresh);
      $('#layout').on('click', layout);
      $('#sync-elements').on('click', syncElements);

    </script>
  </body>
</html>
