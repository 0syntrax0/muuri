/*!
 * Muuri v0.3.0-dev
 * https://github.com/haltu/muuri
 * Copyright (c) 2015, Haltu Oy
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
!function(t,e){var i="Muuri",n=t.Hammer;t[i]=e(t,n)}(this,function(t,e,n){"use strict";function o(e){var i,n=this,l=n._settings=c({},o.defaultSettings,e||{});if(!document.body.contains(l.container))throw new Error("Container must be an existing DOM element");n._element=l.container,b(l.container,l.containerClass),n._id=++z,n._emitter=new a,n._itemShow="function"==typeof l.show?l.show():H("show",l.show),n._itemHide="function"==typeof l.hide?l.hide():H("hide",l.hide),n._dragSort="function"==typeof l.dragSortPredicate?l.dragSortPredicate:Q,n._items=Array.prototype.slice.call(l.items).map(function(t){return new r(n,t)}),(l.layoutOnResize||0===l.layoutOnResize)&&(i=g(function(){n.refresh(),n.layout()},l.layoutOnResize),n._resizeHandler=function(){i()},t.addEventListener("resize",n._resizeHandler)),l.layoutOnInit&&n.layout(!0)}function r(t,e){var i,n,o=this,r=t._settings;if(e.contains(t._element))throw new Error("Item element must not be a parent of the grid container element");e.parentNode!==t._element&&t._element.appendChild(e),i="none"===p(e,"display"),o._id=++z,o._muuri=t,o._element=e,o._child=e.children[0],o._animate=new s(e),o._animateChild=new s(o._child),b(e,r.itemClass),o._isActive=!i,o._isPositioning=!1,o._isHidden=i,o._isHiding=!1,o._isShowing=!1,o._visibilityQueue=[],o._layoutQueue=[],v(o._element,{left:"0",top:"0",transform:"translateX(0px) translateY(0px)"}),b(e,i?r.hiddenClass:r.shownClass),n=t[i?"_itemHide":"_itemShow"].styles,n&&v(o._child,n),i||v(o._element,{display:"block"}),o._refresh(),o._left=0,o._top=0,o._drag={active:!1},o._release={active:!1},t._settings.dragEnabled&&o._initDrag()}function l(t,e){var i,n,o=this,r=t._settings.layout,a=t._element,s=a.getBoundingClientRect();if(o.muuri=t,o.items=e?e.concat():t.get("active"),o.slots={},o.setWidth=!1,o.setHeight=!1,o.width=s.width-_(a,"border-left-width")-_(a,"border-right-width"),o.height=s.height-_(a,"border-top-width")-_(a,"border-bottom-width"),"function"==typeof r)r.call(o);else{if(i="string"==typeof r,n=i?r:r[0],"function"!=typeof l.methods[n])throw new Error('Layout method "'+n+'" does not exist.');l.methods[n].call(o,i?{}:r[1])}}function a(){}function s(t){var e=this;e._element=t,e._isAnimating=!1,e._props=[],e._callback=null}function f(t){var e,i,n,o,r=this,l=[],a=!!t.fillGaps,s=!!t.horizontal,h=!!t.alignRight,u=!!t.alignBottom;if(s?(r.setWidth=!0,r.width=0):(r.setHeight=!0,r.height=0),r.items.length){for(o=0;o<r.items.length;o++)n=r.items[o],i=f.getSlot(r,l,n._width,n._height,!s,a),s?r.width=Math.max(r.width,i.left+i.width):r.height=Math.max(r.height,i.top+i.height),r.slots[n._id]=i;if(h||u)for(e=Object.keys(r.slots),o=0;o<e.length;o++)i=r.slots[e[o]],h&&(i.left=r.width-(i.left+i.width)),u&&(i.top=r.height-(i.top+i.height))}}function h(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function u(t,e,i){t.splice(i,0,t.splice(e,1)[0])}function m(t){var e,i=[],n=t.length;if(n)for(i[0]=t[0],e=1;e<n;e++)i.indexOf(t[e])<0&&(i[i.length]=t[e]);return i}function d(t){return"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)}function c(t){var e,i=arguments.length;for(e=1;e<i;e++)Object.keys(arguments[e]).forEach(function(e){"styles"!==e&&d(t[e])&&d(this[e])?c(t[e],this[e]):t[e]=this[e]},arguments[e]);return t}function g(e,i){var o,r="cancel",l="finish";return function(a){o!==n&&(o=t.clearTimeout(o),a===l&&e()),a!==r&&a!==l&&(o=t.setTimeout(function(){o=n,e()},i))}}function p(e,i){return i="transform"===i?I.styleName||i:"transition"===i?F.styleName||i:i,t.getComputedStyle(e,null).getPropertyValue(i)}function _(t,e){return parseFloat(p(t,e))||0}function y(t,e){return parseFloat((p(t,"transform")||"").replace("matrix(","").split(",")["x"===e?4:5])||0}function v(t,e){var i,n,o,r=Object.keys(e);for(o=0;o<r.length;o++)i=r[o],n=e[i],"transform"===i&&I&&(i=I.propName),"transition"===i&&F&&(i=F.propName),t.style[i]=n}function w(t,e){return(" "+t.className).indexOf(" "+e)>-1}function b(t,e){t.classList?t.classList.add(e):w(t,e)&&(t.className+=" "+e)}function C(t,e){t.classList?t.classList.remove(e):w(t,e)&&(t.className=(" "+t.className+" ").replace(" "+e+" "," ").trim())}function D(t){var e,i,o,r=document.documentElement,l=t.charAt(0).toUpperCase()+t.slice(1),a=["","Webkit","Moz","O","ms"];for(o=0;o<a.length;o++)if(e=a[o],i=e?e+l:t,r.style[i]!==n)return e=e.toLowerCase(),{prefix:e,propName:i,styleName:e?"-"+e+"-"+t:t};return null}function S(t,e){var i=P(e,"margin"),n=P(A(t)||document,"padding");return{left:i.left-n.left,top:i.top-n.top}}function x(e){var i=[],n=/(auto|scroll)/,o=e.parentNode;if(B){if("fixed"===p(e,"position"))return i;for(;o&&o!==document&&o!==document.documentElement;)n.test(p(o,"overflow")+p(o,"overflow-y")+p(o,"overflow-x"))&&(i[i.length]=o),o="fixed"===p(o,"position")?null:o.parentNode;null!==o&&(i[i.length]=t)}else{for(;o&&o!==document;)"fixed"!==p(e,"position")||O(o)?(n.test(p(o,"overflow")+p(o,"overflow-y")+p(o,"overflow-x"))&&(i[i.length]=o),e=o,o=o.parentNode):o=o.parentNode;i.length&&i[i.length-1]===document.documentElement&&(i[i.length-1]=t)}return i}function R(){if(!I)return!0;var t,e,i=document.createElement("div"),n=document.createElement("div");return v(i,{display:"block",visibility:"hidden",position:"absolute",width:"1px",height:"1px",left:"1px",top:"0",margin:"0",transform:"none"}),v(n,{display:"block",position:"fixed",width:"1px",height:"1px",left:"0",top:"0",margin:"0",transform:"none"}),i.appendChild(n),document.body.appendChild(i),t=n.getBoundingClientRect().left,i.style[I.propName]="translateX(0)",e=n.getBoundingClientRect().left,document.body.removeChild(i),e===t}function O(t){var e=p(t,"transform"),i=p(t,"display");return"none"!==e&&"inline"!==i&&"none"!==i}function A(e){if(e===document)return null;if(e===t)return document;var i=p(e,"position");if("relative"===i)return e;if("fixed"!==i&&"absolute"!==i)return null;if("fixed"===i&&B)return t;var n=e===document.documentElement?document:e.parentElement||null;if("fixed"===i){for(;n&&n!==document&&!O(n);)n=n.parentElement||document;return n===document?t:n}for(;n&&n!==document&&"static"===p(n,"position")&&!O(n);)n=n.parentElement||document;return n}function P(e,i){var n={left:0,top:0};if(e===document)return n;if(n.left=t.pageXOffset||0,n.top=t.pageYOffset||0,e.self===t.self)return n;var o=e.getBoundingClientRect();if(n.left+=o.left,n.top+=o.top,i=i||"border","margin"===i){var r=_(e,"margin-left"),l=_(e,"margin-top");n.left-=r>0?r:0,n.top-=l>0?l:0}else"border"!==i&&(n.left+=_(e,"border-left-width"),n.top+=_(e,"border-top-width"));return"content"===i&&(n.left+=_(e,"padding-left"),n.top+=_(e,"padding-top")),n}function E(t,e,i){return{type:t,event:e,currentLeft:i.left,currentTop:i.top,gridLeft:i.gridX,gridTop:i.gridY}}function X(t,e,i){this.isResolved||(this.isResolved=!0,i(t))}function k(t){var e,i,n;if(!t.elementStyles)for(e=["width","height","padding","margin"],t.elementStyles={},n=0;n<4;n++)i=e[n],t.elementStyles[i]=t.element.style[i]||"",t.element.style[i]=p(t.element,i)}function Y(t){var e,i,n;if(t.elementStyles){for(e=Object.keys(t.elementStyles),n=0;n<e.length;n++)i=e[n],t.element.style[i]=t.elementStyles[i];t.elementStyles=null}}function L(t,e,i,n,o){var r,l,a,s,f=t.get(i),h="function"==typeof n?n:o,u=f.length,m="show"===e,d=m?V:K,c=m?J:Z,g=n===!0,p=!1;if(u){for(r=[],l=[],t._emitter.emit(d,f),s=0;s<f.length;s++)a=f[s],(m&&!a._isActive||!m&&a._isActive)&&(p=!0,m&&(a._noLayoutAnimation=!0,l[l.length]=a)),a["_"+e](g,function(e,i){e||(r[r.length]=i),--u<1&&("function"==typeof h&&h(r),t._emitter.emit(c,r))});p&&(l.length&&t.refresh(l),t.layout())}else"function"==typeof o&&o(f)}function H(t,e){var i=parseInt(e&&e.duration)||0,n=i>0,o=e&&e.easing||"ease",r=e&&d(e.styles)?e.styles:null;return{styles:r,start:function(t,e,l){n&&r?e?(v(t._child,r),l()):t._animateChild.start(r,{duration:i,easing:o,done:l}):l()},stop:function(t){t._animateChild.stop()}}}function N(t,e,i){var n,o=t.splice(0,t.length);for(n=0;n<o.length;n++)o[n](e,i)}function Q(t){var e,i,n,o,r,l=t._muuri,a=l._settings,s=a.dragSortPredicate||{},f=s.tolerance||50,h=s.action||"move",u=l._items,m=t._drag,d={width:m.item._width-m.item._margin.left-m.item._margin.right,height:m.item._height-m.item._margin.top-m.item._margin.bottom,left:m.gridX+m.item._margin.left,top:m.gridY+m.item._margin.top},c=0,g=null;for(r=0;r<u.length;r++)o=u[r],o===t?c=r:o._isActive&&(n={width:o._width-o._margin.left-o._margin.right,height:o._height-o._margin.top-o._margin.bottom,left:o._left+o._margin.left,top:o._top+o._margin.top},i=M(d,n),(null===g||i>g)&&(g=i,e=r));return null!==g&&g>=f&&{action:h,from:c,to:e}}function M(t,e){if(t.left+t.width<=e.left||e.left+e.width<=t.left||t.top+t.height<=e.top||e.top+e.height<=t.top)return 0;var i=Math.min(t.left+t.width,e.left+e.width)-Math.max(t.left,e.left),n=Math.min(t.top+t.height,e.top+e.height)-Math.max(t.top,e.top),o=Math.min(t.width,e.width),r=Math.min(t.height,e.height);return i*n/(o*r)*100}var j="Muuri",z=0,I=D("transform"),F=D("transition"),T=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||t.oRequestAnimationFrame||null,B=R(),W="refresh",q="synchronize",G="layoutstart",U="layoutend",V="showstart",J="showend",K="hidestart",Z="hideend",$="move",tt="swap",et="add",it="remove",nt="dragstart",ot="dragmove",rt="dragscroll",lt="dragend",at="releasestart",st="releaseend",ft="destroy";return o.Item=r,o.Layout=l,o.Animate=s,o.Emitter=a,o.defaultSettings={container:null,items:[],show:{duration:300,easing:"ease",styles:{opacity:1,transform:"scale(1)"}},hide:{duration:300,easing:"ease",styles:{opacity:0,transform:"scale(0.5)"}},layout:"firstFit",layoutOnResize:100,layoutOnInit:!0,layoutDuration:300,layoutEasing:"ease",dragEnabled:!1,dragContainer:null,dragPredicate:null,dragSort:!0,dragSortInterval:50,dragSortPredicate:{tolerance:50,action:"move"},dragReleaseDuration:300,dragReleaseEasing:"ease",containerClass:"muuri",itemClass:"muuri-item",shownClass:"muuri-shown",hiddenClass:"muuri-hidden",positioningClass:"muuri-positioning",draggingClass:"muuri-dragging",releasingClass:"muuri-releasing"},o.prototype._getItem=function(t){var e,i,n,o,l=this;if(t){if(t instanceof r)return t._muuri===l?t:null;if("number"==typeof t)return e=t>-1?t:l._items.length+t,l._items[e]||null;for(i=null,o=0;o<l._items.length;o++)if(n=l._items[o],n._element===t){i=n;break}return i}return l._items[0]||null},o.prototype.on=function(t,e){return this._emitter.on(t,e),this},o.prototype.off=function(t,e){return this._emitter.off(t,e),this},o.prototype.refresh=function(t){var e,i=this.get(t||"active");for(e=0;e<i.length;e++)i[e]._refresh();this._emitter.emit(W,i)},o.prototype.get=function(t,e){var i,n,o,r,l=this,a=t&&"string"!=typeof t,s=a?[].concat(t):null,f=a?e:t,h=[];if(f="string"==typeof f?f:null,f||s){for(s=s||l._items,i="active"===f,n="inactive"===f,r=0;r<s.length;r++)o=a?l._getItem(s[r]):s[r],o&&(!f||i&&o._isActive||n&&!o._isActive)&&(h[h.length]=o);return h}return h.concat(l._items)},o.prototype.add=function(t,e){var i,n,o,l,a=this,s=[].concat(t),f=[],h=a._items,u=!1;for(l=0;l<h.length;l++)n=s.indexOf(h[l]._element),n>-1&&s.splice(n,1);if(!s.length)return f;for(l=0;l<s.length;l++)o=new r(a,s[l]),f[f.length]=o,o._isActive&&(u=!0,o._noLayoutAnimation=!0);return i="number"==typeof e?e:-1,i=i<0?h.length-i+1:i,h.splice.apply(h,[i,0].concat(f)),u&&a.layout(),a._emitter.emit(et,f),f},o.prototype.remove=function(t,e){var i,n,o=this,r=o.get(t),l=[],a=!1;for(n=0;n<r.length;n++)i=r[n],i._isActive&&(a=!0),l[l.length]=i._destroy(e);return a&&o.layout(),o._emitter.emit(it,l),l},o.prototype.synchronize=function(){var t,e,i=this,n=i._element,o=i._items;for(e=0;e<o.length;e++)t=o[e]._element,t.parentNode===n&&n.appendChild(t);i._emitter.emit(q)},o.prototype.layout=function(t,e){var i,n,o,r=this,a=r._emitter,s="function"==typeof t?t:e,f=t===!0,h=new l(r),u=-1,m=h.items.length,d=[],c=function(t,e){t||(d[d.length]=e),++u===m&&("function"==typeof s&&s(d,h),a.emit(U,d,h))};if(a.emit(G,h.items,h),h.setHeight&&v(r._element,{height:h.height+"px"}),h.setWidth&&v(r._element,{width:h.width+"px"}),m)for(o=0;o<h.items.length;o++)i=h.items[o],n=h.slots[i._id],i._left=n.left,i._top=n.top,i._drag.active?c(!1,i):i._layout(f,c);else c(!0)},o.prototype.show=function(t,e,i){L(this,"show",t,e,i)},o.prototype.hide=function(t,e,i){L(this,"hide",t,e,i)},o.prototype.indexOf=function(t){var e,i=this._items;if("number"==typeof t)return t<=i.length-1?t:-1;if(t instanceof r)return i.indexOf(t);for(e=0;e<i.length;e++)if(i[e]._element===t)return e;return-1},o.prototype.move=function(t,e){var i=this;t=i._getItem(t),e=i._getItem(e),t&&e&&t!==e&&(u(i._items,i._items.indexOf(t),i._items.indexOf(e)),i._emitter.emit($,t,e))},o.prototype.swap=function(t,e){var i=this;t=i._getItem(t),e=i._getItem(e),t&&e&&t!==e&&(h(i._items,i._items.indexOf(t),i._items.indexOf(e)),i._emitter.emit(tt,t,e))},o.prototype.destroy=function(){var e,i,n=this,r=n._element,l=n._items.concat(),a=n._emitter,s=Object.keys(n).concat(Object.keys(o.prototype));for(n._resizeHandler&&t.removeEventListener("resize",n._resizeHandler),i=0;i<l.length;i++)l[i]._destroy();for(C(r,n._settings.containerClass),v(r,{height:""}),a.emit(ft),e=Object.keys(a._events||{}),i=0;i<e.length;i++)a._events[e[i]].length=0;for(i=0;i<s.length;i++)n[s[i]]=null},r.prototype.getData=function(){var t=this;return{element:t._element,width:t._width,height:t._height,margin:{left:t._margin.left,top:t._margin.top,right:t._margin.right,bottom:t._margin.bottom},left:t._left,top:t._top,active:t._isActive,positioning:t._isPositioning,dragging:t._drag.active,releasing:t._release.active,visibility:t._isHiding?"hiding":t._isShowing?"showing":t._isHidden?"hidden":"shown"}},r.prototype._initDrag=function(){if(!e)throw Error("["+j+"] required dependency Hammer is not defined.");var t=this,i=t._muuri._settings,n=t._drag,o=!1,r=t._hammer=new e.Manager(t._element);r.add(new e.Pan({event:"drag",pointers:1,threshold:0,direction:e.DIRECTION_ALL})),r.add(new e.Press({event:"draginit",pointers:1,threshold:100,time:0})),r.set({touchAction:"none"}),t._resetReleaseData(),t._resetDragData(),n.checkOverlap=g(function(){n.active&&t._checkOverlap()},i.dragSortInterval),n.predicate="function"==typeof i.dragPredicate?i.dragPredicate:X,n.predicateData={},n.isPredicateResolved=function(){return o},n.resolvePredicate=function(e){o||"draginitup"===e.type||"dragend"===e.type||"dragcancel"===e.type||(o=!0,t._onDragStart(e))},n.onScroll=function(e){T?T(function(){t._onDragScroll(e)}):t._onDragScroll(e)},r.on("draginit",function(e){n.predicateData={},o=!1,n.predicate.call(n.predicateData,e,t,n.resolvePredicate)}).on("dragstart dragmove",function(e){o&&n.active&&t._onDragMove(e),n.predicate.call(n.predicateData,e,t,n.resolvePredicate)}).on("dragend dragcancel draginitup",function(e){o&&n.active&&t._onDragEnd(e),n.predicate.call(n.predicateData,e,t,n.resolvePredicate)})},r.prototype._resetDragData=function(){var t=this._drag;t.active=!1,t.start=null,t.lastMove=null,t.move=null,t.item=null,t.element=null,t.elementStyles=null,t.scrollParents=[],t.left=0,t.top=0,t.gridX=0,t.gridY=0,t.elementClientX=0,t.elementClientY=0,t.containerDiffX=0,t.containerDiffY=0},r.prototype._onDragStart=function(t){var e,i,n,o,r,l,a,s=this,f=s._drag,h=s._muuri._settings,u=s._release.active;if(s._isActive){for(s._isPositioning&&s._stopLayout(),u&&(f.elementStyles=s._release.elementStyles,C(s._element,h.releasingClass),s._resetReleaseData()),f.active=!0,f.start=t,f.lastMove=t,f.move=t,f.item=s,f.element=s._element,e=y(f.element,"x"),i=y(f.element,"y"),n=s._muuri._element,o=h.dragContainer,f.left=f.gridX=e,f.top=f.gridY=i,o&&o!==n&&(f.element.parentNode===o?(r=S(f.element,n),f.containerDiffX=r.left,f.containerDiffY=r.top,f.gridX=e-f.containerDiffX,f.gridY=i-f.containerDiffY):(k(f),o.appendChild(f.element),r=S(f.element,n),f.containerDiffX=r.left,f.containerDiffY=r.top,f.left=e+f.containerDiffX,f.top=i+f.containerDiffY,v(f.element,{transform:"translateX("+f.left+"px) translateY("+f.top+"px)"}))),l=f.element.getBoundingClientRect(),f.elementClientX=l.left,f.elementClientY=l.top,f.scrollParents=x(f.element),o&&o!==n&&(f.scrollParents=m(f.scrollParents.concat(x(n)))),a=0;a<f.scrollParents.length;a++)f.scrollParents[a].addEventListener("scroll",f.onScroll);b(f.element,h.draggingClass),s._muuri._emitter.emit(nt,s,E("dragstart",t,f))}},r.prototype._onDragMove=function(t){var e,i,n=this,o=n._drag,r=n._muuri._settings;return n._isActive?(e=t.deltaX-o.move.deltaX,i=t.deltaY-o.move.deltaY,o.lastMove=o.move,o.move=t,o.left+=e,o.top+=i,o.gridX+=e,o.gridY+=i,o.elementClientX+=e,o.elementClientY+=i,v(o.element,{transform:"translateX("+o.left+"px) translateY("+o.top+"px)"}),r.dragSort&&o.checkOverlap(),void n._muuri._emitter.emit(ot,n,E("dragmove",t,o))):void n._resetDrag()},r.prototype._onDragScroll=function(t){var e,i=this,n=i._drag,o=i._muuri._settings,r=i._muuri._element,l=o.dragContainer,a=n.element.getBoundingClientRect(),s=n.elementClientX-a.left,f=n.elementClientY-a.top;l&&l!==r&&(e=S(n.element,r),n.containerDiffX=e.left,n.containerDiffY=e.top),n.left+=s,n.top+=f,n.gridX=n.left-n.containerDiffX,n.gridY=n.top-n.containerDiffY,v(n.element,{transform:"translateX("+n.left+"px) translateY("+n.top+"px)"}),o.dragSort&&n.checkOverlap(),i._muuri._emitter.emit(rt,i,E("dragscroll",t,n))},r.prototype._onDragEnd=function(t){var e,i=this,n=i._drag,o=i._muuri._settings,r=i._release;if(!i._isActive)return void i._resetDrag();for(o.dragSort&&n.checkOverlap("finish"),e=0;e<n.scrollParents.length;e++)n.scrollParents[e].removeEventListener("scroll",n.onScroll);C(n.element,o.draggingClass),n.active=!1,i._muuri._emitter.emit(lt,i,E("dragend",t,n)),r.item=n.item,r.containerDiffX=n.containerDiffX,r.containerDiffY=n.containerDiffY,r.element=n.element,r.elementStyles=n.elementStyles,i._resetDragData(),i._startRelease()},r.prototype._resetDrag=function(){var t=this,e=t._drag,n=t._muuri._settings;for(i=0;i<e.scrollParents.length;i++)e.scrollParents[i].removeEventListener("scroll",e.onScroll);e.checkOverlap("cancel"),C(e.element,n.draggingClass),Y(e),t._resetDragData()},r.prototype._resetReleaseData=function(){var t=this._release;t.active=!1,t.item=null,t.positioningStarted=!1,t.containerDiffX=0,t.containerDiffY=0,t.element=null,t.elementStyles=null},r.prototype._startRelease=function(){var t=this,e=t._muuri._settings,i=t._release;i.active=!0,b(i.element,e.releasingClass),t._muuri._emitter.emit(at,t),t._layout(!1)},r.prototype._endRelease=function(){var t=this,e=t._muuri._settings,i=t._release;C(i.element,e.releasingClass),i.element.parentNode!==t._muuri._element&&(t._muuri._element.appendChild(i.element),v(i.element,{transform:"translateX("+t._left+"px) translateY("+t._top+"px)"})),Y(i),t._resetReleaseData(),t._muuri._emitter.emit(st,t)},r.prototype._checkOverlap=function(){var t,e,i,n,o,r,l=this._muuri,a=l._dragSort(this);a&&(t=l._items,e=a.action||"move",i=a.from,n=a.to,o=t[i]._element,r=t[n]._element,"swap"===e?(h(t,i,n),l._emitter.emit(tt,o,r)):(u(t,i,n),l._emitter.emit($,o,r)),l.layout())},r.prototype._stopLayout=function(){var t=this,e=t._muuri._settings;t._isPositioning&&(t._animate.stop(),C(t._element,e.positioningClass),t._isPositioning=!1,N(t._layoutQueue,!0,t))},r.prototype._refresh=function(){var t,e,i,n,o,r=this,l=r._element;if(!r._isHidden){for(e=["left","right","top","bottom"],r._margin=i={},o=0;o<4;o++)n=_(l,"margin-"+e[o]),i[e[o]]=n>0?n:0;t=l.getBoundingClientRect(),r._width=t.width+i.left+i.right,r._height=t.height+i.top+i.bottom}},r.prototype._layout=function(t,e){var i,n,o,r,l=this,a=l._muuri._settings,s=l._release,f=s.active&&s.positioningStarted===!1,h=f?a.dragReleaseDuration:a.layoutDuration,u=f?a.dragReleaseEasing:a.layoutEasing,m=t!==!0&&!l._noLayoutAnimation&&h>0,d=l._isPositioning,c=function(){C(l._element,a.positioningClass),l._isPositioning=!1,s.active&&l._endRelease(),N(l._layoutQueue,!1,l)};if(l._stopLayout(),"function"==typeof e&&(l._layoutQueue[l._layoutQueue.length]=e),f&&(s.positioningStarted=!0),i=l._release.active?l._release.containerDiffX:0,n=l._release.active?l._release.containerDiffY:0,m){if(o=y(l._element,"x")-i,r=y(l._element,"y")-n,l._left===o&&l._top===r)return void c();l._isPositioning=!0,d||b(l._element,a.positioningClass),l._animate.start({transform:"translateX("+(l._left+i)+"px) translateY("+(l._top+n)+"px)"},{duration:h,easing:u,done:c})}else l._noLayoutAnimation&&(l._noLayoutAnimation=!1),v(l._element,{transform:"translateX("+(l._left+i)+"px) translateY("+(l._top+n)+"px)"}),c()},r.prototype._show=function(t,e){var i=this,n=i._muuri._settings;i._isHidden||i._isShowing?i._isHidden?(i._muuri._itemHide.stop(i),i._isActive=!0,i._isHidden=!1,i._isShowing=i._isHiding=!1,b(i._element,n.shownClass),C(i._element,n.hiddenClass),v(i._element,{display:"block"}),N(i._visibilityQueue,!0,i),i._isShowing=!0,"function"==typeof e&&(i._visibilityQueue[i._visibilityQueue.length]=e),i._muuri._itemShow.start(i,t,function(){N(i._visibilityQueue,!1,i)})):"function"==typeof e&&(i._visibilityQueue[i._visibilityQueue.length]=e):"function"==typeof e&&e(!1,i)},r.prototype._hide=function(t,e){var i=this,n=i._muuri._settings;i._isHidden&&!i._isHiding?"function"==typeof e&&e(!1,i):i._isHidden?"function"==typeof e&&(i._visibilityQueue[i._visibilityQueue.length]=e):(i._muuri._itemShow.stop(i),i._isActive=!1,i._isHidden=!0,i._isShowing=i._isHiding=!1,b(i._element,n.hiddenClass),C(i._element,n.shownClass),N(i._visibilityQueue,!0,i),i._isHiding=!0,"function"==typeof e&&(i._visibilityQueue[i._visibilityQueue.length]=e),i._muuri._itemHide.start(i,t,function(){v(i._element,{display:"none"}),N(i._visibilityQueue,!1,i)}))},r.prototype._destroy=function(t){var e,i=this,n=i._muuri,o=n._settings,l=i._element,a=n._items.indexOf(i),s=Object.keys(i).concat(Object.keys(r.prototype));for(i._stopLayout(),n._itemShow.stop(i),n._itemHide.stop(i),i._release.active&&(l.parentNode!==n._element&&n._element.appendChild(l),i._resetReleaseData()),i._drag.active&&(l.parentNode!==n._element&&n._element.appendChild(l),i._resetDrag()),i._hammer&&i._hammer.destroy(),i._animate.destroy(),i._animateChild.destroy(),l.removeAttribute("style"),i._child.removeAttribute("style"),N(i._visibilityQueue,!0,i),C(l,o.positioningClass),C(l,o.draggingClass),C(l,o.releasingClass),C(l,o.itemClass),C(l,o.shownClass),C(l,o.hiddenClass),a>-1&&n._items.splice(a,1),t&&l.parentNode.removeChild(l),e=0;e<s.length;e++)i[s[e]]=null},l.methods={firstFit:f},a.prototype.on=function(t,e){var i=this._events=this._events||{},n=i[t]||[];return n[n.length]=e,i[t]=n,this},a.prototype.off=function(t,e){var n=this._events=this._events||{},o=n[t]||[],r=o.length;if(r)for(;r--;)e===o[i]&&o.splice(r,1);return this},a.prototype.emit=function(t,e,i,n){var o,r,l=this._events=this._events||{},a=l[t]||[],s=a.length;if(s)for(o=arguments.length-1,a=a.concat(),r=0;r<s;r++)0===o?a[r]():1===o?a[r](e):2===o?a[r](e,i):a[r](e,i,n);return this},s.prototype.start=function(t,e){var i=this,n=i._element,o=t||{},r=e||{},l=r.done,a=F.propName;return F?(i.stop(),i._isAnimating=!0,i._props=Object.keys(o),F&&(o[a+"Property"]=i._props.join(","),o[a+"Duration"]=(r.duration||400)+"ms",o[a+"Delay"]=(r.delay||0)+"ms",o[a+"Easing"]=r.easing||"ease"),i._callback=function(t){t.target===n&&(i.stop(),"function"==typeof l&&l())},n.addEventListener("transitionend",i._callback,!0),n.offsetWidth,void v(n,o)):(v(n,o),void("function"==typeof l&&l()))},s.prototype.stop=function(){if(F){var t,e=this,i=e._element,n=e._callback,o=e._props,r=F.propName,l={};if(e._isAnimating){for("function"==typeof n&&(i.removeEventListener("transitionend",n,!0),e._callback=null),t=0;t<o.length;t++)l[o[t]]=p(i,o[t]);l[r+"Property"]="",l[r+"Duration"]="",l[r+"Delay"]="",l[r+"Easing"]="",v(i,l),e._isAnimating=!1}}},s.prototype.destroy=function(){var t=this;t.stop(),t._element=null,t._isAnimating=null,t._props=null,t._callback=null},f.getSlot=function(t,e,i,n,o,r){var l,a,s,h,u,m=e[0]||[],d=[],c={left:null,top:null,width:i,height:n};for(h=0;h<m.length;h++)if(l=m[h],c.width<=l.width&&c.height<=l.height){c.left=l.left,c.top=l.top;break}for(null===c.left&&(c.left=o?0:t.width,c.top=o?t.height:0,r||(s=!0)),o&&c.top+c.height>t.height&&(c.left>0&&(d[d.length]={left:0,top:t.height,width:c.left,height:1/0}),c.left+c.width<t.width&&(d[d.length]={left:c.left+c.width,top:t.height,width:t.width-c.left-c.width,height:1/0}),t.height=c.top+c.height),!o&&c.left+c.width>t.width&&(c.top>0&&(d[d.length]={left:t.width,top:0,width:1/0,height:c.top}),c.top+c.height<t.height&&(d[d.length]={left:t.width,top:c.top+c.height,width:1/0,height:t.height-c.top-c.height}),t.width=c.left+c.width),h=r?0:s?m.length:h;h<m.length;h++)for(a=f.splitRect(m[h],c),u=0;u<a.length;u++)l=a[u],l.width>0&&l.height>0&&(o&&l.top<t.height||!o&&l.left<t.width)&&(d[d.length]=l);return f.purgeSlots(d).sort(o?f.sortRectsTopLeft:f.sortRectsLeftTop),e[0]=d,c},f.sortRectsTopLeft=function(t,e){return t.top<e.top?-1:t.top>e.top?1:t.left<e.left?-1:t.left>e.left?1:0},f.sortRectsLeftTop=function(t,e){return t.left<e.left?-1:t.left>e.left?1:t.top<e.top?-1:t.top>e.top?1:0},f.isRectWithinRect=function(t,e){return t.left>=e.left&&t.top>=e.top&&t.left+t.width<=e.left+e.width&&t.top+t.height<=e.top+e.height},f.purgeSlots=function(t){for(var e,i,n,o=t.length;o--;)for(i=t[o],e=t.length;e--;)if(n=t[e],o!==e&&f.isRectWithinRect(i,n)){t.splice(o,1);break}return t},f.splitRect=function(t,e){var i=[],n=!(e.left>t.left+t.width||e.left+e.width<t.left||e.top>t.top+t.height||e.top+e.height<t.top);return n?(t.left<e.left&&(i[i.length]={left:t.left,top:t.top,width:e.left-t.left,height:t.height}),t.left+t.width>e.left+e.width&&(i[i.length]={left:e.left+e.width,top:t.top,width:t.left+t.width-(e.left+e.width),height:t.height}),t.top<e.top&&(i[i.length]={left:t.left,top:t.top,width:t.width,height:e.top-t.top}),t.top+t.height>e.top+e.height&&(i[i.length]={left:t.left,top:e.top+e.height,width:t.width,height:t.top+t.height-(e.top+e.height)})):i[0]=t,i},o});