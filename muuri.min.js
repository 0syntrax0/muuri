/*!
 * Muuri v0.3.0-dev
 * https://github.com/haltu/muuri
 * Copyright (c) 2015, Haltu Oy
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
!function(t,e){var i,n,o="Muuri";if("function"==typeof define&&define.amd)define(function(r){return i=r.defined&&r.defined("velocity")?r("velocity"):void 0,n=r.defined&&r.defined("hammer")?r("hammer"):void 0,e(t,o,i,n)});else if("object"==typeof module&&module.exports){try{i=require("velocity-animate")}catch(r){}try{n=require("hammerjs")}catch(r){}module.exports=e(t,o,i,n)}else i="function"==typeof t.jQuery?t.jQuery.Velocity:t.Velocity,n=t.Hammer,t[o]=e(t,o,i,n)}(this,function(t,e,n,o,r){"use strict";function s(e){var i,n=this,o=n._settings=C(s.defaultSettings,e);if(!document.body.contains(o.container))throw new Error("Container must be an existing DOM element");n._element=o.container,X(o.container,o.containerClass),n._id=++G,n._layout=null,n._emitter=new s.Emitter,n._itemShowHandler="function"==typeof o.show?o.show():q("show",o.show),n._itemHideHandler="function"==typeof o.hide?o.hide():q("hide",o.hide),n.refresh(),n._items=Array.prototype.slice.call(o.items).map(function(t){return new s.Item(n,t)}),"number"!=typeof o.layoutOnResize&&o.layoutOnResize!==!0||(i=A(function(){n.refresh().refreshItems().layoutItems()},Math.max(0,parseInt(o.layoutOnResize)||0)),n._resizeHandler=function(){i()},t.addEventListener("resize",n._resizeHandler)),o.layoutOnInit&&n.layoutItems(!0)}function l(t,e){var i,n=this,o=t._settings;if(e.contains(t._element))throw new Error("Item element must be within the grid container element");e.parentNode!==t._element&&t._element.appendChild(e),X(e,o.itemClass),i="none"===S(e,"display"),X(e,i?o.itemHiddenClass:o.itemVisibleClass),n._id=++G,n._muuri=t,n._element=e,n._child=e.children[0],n._animate=new s.AnimateLayout(n,e),n._animateChild=new s.AnimateVisibility(n,n._child),n._isDefaultAnimate=n._animate instanceof d,n._isDefaultChildAnimate=n._animateChild instanceof d,n._isActive=!i,n._isPositioning=!1,n._isHidden=i,n._isHiding=!1,n._isShowing=!1,n._visibilityQueue=[],n._layoutQueue=[],n._left=0,n._top=0,H(n._element,{left:"0",top:"0",transform:"translateX(0px) translateY(0px)",display:i?"none":"block"}),n._refresh(),i?t._itemHideHandler.start(n,!0):t._itemShowHandler.start(n,!0),n._drag=o.dragEnabled?new s.Drag(n):null,n._migrate={isActive:!1,container:null,containerDiffX:0,containerDiffY:0,sender:null,index:0}}function a(t,e){var i=this,n=t._settings.layout,o=t._padding,r=t._border;i.muuri=t,i.items=e?e.concat():t.getItems("active"),i.slots={},i.setWidth=!1,i.setHeight=!1,i.width=t._width-r.left-r.right-o.left-o.right,i.height=t._height-r.top-r.bottom-o.top-o.bottom,"function"==typeof n?n(i):h(i,y(n)?n:{})}function h(t,e){var i,n,o,r,s=[],l=!!e.fillGaps,a=!!e.horizontal,u=!!e.alignRight,d=!!e.alignBottom;if(a?(t.setWidth=!0,t.width=0):(t.setHeight=!0,t.height=0),t.items.length){for(r=0;r<t.items.length;r++)o=t.items[r],n=h.getSlot(t,s,o._outerWidth,o._outerHeight,!a,l),a?t.width=Math.max(t.width,n.left+n.width):t.height=Math.max(t.height,n.top+n.height),t.slots[o._id]=n;if(u||d)for(i=Object.keys(t.slots),r=0;r<i.length;r++)n=t.slots[i[r]],u&&(n.left=t.width-(n.left+n.width)),d&&(n.top=t.height-(n.top+n.height))}}function u(){}function d(t,i){this._element=i,this._queue=e+"-"+ ++G,this._isAnimating=!1}function f(t){if(!o)throw Error("["+e+"] required dependency Hammer is not defined.");var i,n=this,r=t._muuri._settings,s="function"==typeof r.dragStartPredicate?r.dragStartPredicate:f.defaultStartPredicate,l=null,a=null;n._item=t,n._hammer=i=new o.Manager(t._element),n._setupDragData(),n._setupReleaseData(),n._checkSortOverlap=A(function(){n._drag.isActive&&n._checkOverlap()},r.dragSortInterval),n._sortPredicate="function"==typeof r.dragSortPredicate?r.dragSortPredicate:f.defaultSortPredicate,n._scrollHandler=function(t){n._onDragScroll(t)},i.add(new o.Pan({event:"drag",pointers:1,threshold:0,direction:o.DIRECTION_ALL})),i.add(new o.Press({event:"draginit",pointers:1,threshold:1e3,time:0})),i.set({touchAction:"none"}),i.on("draginit dragstart dragmove",function(e){a=e,l||(l=new m(function(){l===this&&n._onDragStart(a)})),l._isResolved&&n._drag.isActive?n._onDragMove(e):l._isRejected||l._isResolved||s.call(t._muuri,t,e,l)}).on("dragend dragcancel draginitup",function(e){l.reject(),s.call(t._muuri,t,e,l),l._isResolved&&n._drag.isActive&&n._onDragEnd(e),l=null,a=null}),N(t._element),N(t._child)}function m(t,e){this._isResolved=!1,this._isRejected=!1,this._onResolved=t,this._onRejected=e}function _(t,e){var i=t.length,n=i-1;return e>n?n:e<0?Math.max(i+e,0):e}function c(t,e,i){if(!(t.length<2)){var n,o=_(t,e),r=_(t,i);o!==r&&(n=t[o],t[o]=t[r],t[r]=n)}}function p(t,e,i){if(!(t.length<2)){var n=_(t,e),o=_(t,i);n!==o&&t.splice(o,0,t.splice(n,1)[0])}}function g(t){var e,i=[],n=t.length;if(n)for(i[0]=t[0],e=1;e<n;e++)i.indexOf(t[e])<0&&(i[i.length]=t[e]);return i}function y(t){return"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)}function v(t){var e=Object.prototype.toString.call(t);return"[object HTMLCollection]"===e||"[object NodeList]"===e}function w(t,e){return Object.keys(e).forEach(function(i){var n=y(e[i]);y(t[i])&&n?(t[i]=w({},t[i]),t[i]=w(t[i],e[i])):t[i]=n?w({},e[i]):Array.isArray(e[i])?e[i].slice(0):e[i]}),t}function b(t){var e={};return Object.keys(t).forEach(function(i){var n=t[i];n!==r&&null!==n&&(e[i]=n)}),e}function C(t,e){var i=w({},t);return i=e?w(i,e):i,i.show&&i.show.styles&&(i.show.styles=b(i.show.styles)),i.hide&&i.hide.styles&&(i.hide.styles=b(i.hide.styles)),i}function D(t,e,i){var n="number"==typeof i?i:-1;t.splice.apply(t,[n<0?t.length-n+1:n,0].concat(e))}function A(e,i){var n,o="cancel",s="finish";return i>0?function(l){n!==r&&(n=t.clearTimeout(n),l===s&&e()),l!==o&&l!==s&&(n=t.setTimeout(function(){n=r,e()},i))}:function(t){t!==o&&e()}}function S(e,i){return t.getComputedStyle(e,null).getPropertyValue("transform"===i?U.styleName||i:i)}function x(t,e){return parseFloat(S(t,e))||0}function R(t,e){return parseFloat((S(t,"transform")||"").replace("matrix(","").split(",")["x"===e?4:5])||0}function H(t,e){var i,n,o,r=Object.keys(e);for(o=0;o<r.length;o++)i=r[o],n=e[i],"transform"===i&&U&&(i=U.propName),t.style[i]=n}function E(t,e){var i,o=Object.keys(e);for(i=0;i<o.length;i++)n.hook(t,o[i],e[o[i]])}function P(t,e){return(t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector).call(t,"."+e)}function X(t,e){t.classList?t.classList.add(e):P(t,e)&&(t.className+=" "+e)}function I(t,e){t.classList?t.classList.remove(e):P(t,e)&&(t.className=(" "+t.className+" ").replace(" "+e+" "," ").trim())}function Y(t){var e,i,n,o=document.documentElement,s=t.charAt(0).toUpperCase()+t.slice(1),l=["","Webkit","Moz","O","ms"];for(n=0;n<l.length;n++)if(e=l[n],i=e?e+s:t,o.style[i]!==r)return e=e.toLowerCase(),{prefix:e,propName:i,styleName:e?"-"+e+"-"+t:t};return null}function M(t,e){var i,n,o=k(t)||document,r={left:0,top:0};return o===e?r:(i=z(o,"padding"),n=z(e,"padding"),{left:n.left-i.left,top:n.top-i.top})}function O(e){var i=[],n=/(auto|scroll)/,o=e.parentNode;if(J){if("fixed"===S(e,"position"))return i;for(;o&&o!==document&&o!==document.documentElement;)n.test(S(o,"overflow")+S(o,"overflow-y")+S(o,"overflow-x"))&&(i[i.length]=o),o="fixed"===S(o,"position")?null:o.parentNode;null!==o&&(i[i.length]=t)}else{for(;o&&o!==document;)"fixed"!==S(e,"position")||j(o)?(n.test(S(o,"overflow")+S(o,"overflow-y")+S(o,"overflow-x"))&&(i[i.length]=o),e=o,o=o.parentNode):o=o.parentNode;i.length&&i[i.length-1]===document.documentElement&&(i[i.length-1]=t)}return i}function L(){if(!U)return!0;var t,e,i=document.createElement("div"),n=document.createElement("div");return H(i,{display:"block",visibility:"hidden",position:"absolute",width:"1px",height:"1px",left:"1px",top:"0",margin:"0",transform:"none"}),H(n,{display:"block",position:"fixed",width:"1px",height:"1px",left:"0",top:"0",margin:"0",transform:"none"}),i.appendChild(n),document.body.appendChild(i),t=n.getBoundingClientRect().left,i.style[U.propName]="scaleX(1)",e=n.getBoundingClientRect().left,document.body.removeChild(i),e===t}function j(t){var e=S(t,"transform"),i=S(t,"display");return"none"!==e&&"inline"!==i&&"none"!==i}function k(e){if(e===document)return null;if(e===t)return document;var i=S(e,"position");if("relative"===i)return e;if("fixed"!==i&&"absolute"!==i)return null;if("fixed"===i&&J)return t;var n=e===document.documentElement?document:e.parentElement||null;if("fixed"===i){for(;n&&n!==document&&!j(n);)n=n.parentElement||document;return n===document?t:n}for(;n&&n!==document&&"static"===S(n,"position")&&!j(n);)n=n.parentElement||document;return n}function z(e,i){var n={left:0,top:0};if(e===document)return n;if(n.left=t.pageXOffset||0,n.top=t.pageYOffset||0,e.self===t.self)return n;var o=e.getBoundingClientRect();if(n.left+=o.left,n.top+=o.top,i=i||"border","margin"===i){var r=x(e,"margin-left"),s=x(e,"margin-top");n.left-=r>0?r:0,n.top-=s>0?s:0}else"border"!==i&&(n.left+=x(e,"border-left-width"),n.top+=x(e,"border-top-width"));return"content"===i&&(n.left+=x(e,"padding-left"),n.top+=x(e,"padding-top")),n}function N(t){var e=t.tagName.toLowerCase();"a"!==e&&"img"!==e||t.addEventListener("dragstart",T,!1)}function Q(t){var e=t.tagName.toLowerCase();"a"!==e&&"img"!==e||t.removeEventListener("dragstart",T,!1)}function V(t,e,i,n,o){var r,s,l,a,h=t.getItems(i),u="function"==typeof n?n:o,d=h.length,f="show"===e,m=f?it:ot,_=f?nt:rt,c=n===!0,p=!1;if(d){for(r=[],s=[],t._emitter.emit(m,h),a=0;a<h.length;a++)l=h[a],(f&&!l._isActive||!f&&l._isActive)&&(p=!0,f&&(l._noLayoutAnimation=!0,s[s.length]=l)),l["_"+e](c,function(e,i){e||(r[r.length]=i),--d<1&&("function"==typeof u&&u(r),t._emitter.emit(_,r))});p&&(s.length&&t.refreshItems(s),t.layoutItems())}else"function"==typeof o&&o(h)}function q(t,e){var i=parseInt(e&&e.duration)||0,n=i>0,o=e&&e.easing||"ease",r=e&&y(e.styles)?e.styles:null;return{start:function(t,e,s){var l;n&&r?e?(t._isDefaultChildAnimate?E(t._child,r):H(t._child,r),s&&s()):(l={duration:i,easing:o,done:s},t._isDefaultChildAnimate?t._animateChild.start(null,r,l):t._animateChild.start(r,l)):s&&s()},stop:function(t){t._animateChild.stop()}}}function B(t,e,i){var n,o=t.splice(0,t.length);for(n=0;n<o.length;n++)o[n](e,i)}function W(t,e){if(t.left+t.width<=e.left||e.left+e.width<=t.left||t.top+t.height<=e.top||e.top+e.height<=t.top)return 0;var i=Math.min(t.left+t.width,e.left+e.width)-Math.max(t.left,e.left),n=Math.min(t.top+t.height,e.top+e.height)-Math.max(t.top,e.top),o=Math.min(t.width,e.width),r=Math.min(t.height,e.height);return i*n/(o*r)*100}function T(t){t.preventDefault&&t.preventDefault()}function F(t,e){var i,n=Object.keys(t).concat(Object.keys(e.prototype));for(i=0;i<n.length;i++)t[n[i]]=null}var G=0,U=Y("transform"),J=L(),K="refresh",Z="refreshitems",$="synchronizeitems",tt="layoutitemsstart",et="layoutitemsend",it="showitemsstart",nt="showitemsend",ot="hideitemsstart",rt="hideitemsend",st="moveitem",lt="senditem",at="receiveitemstart",ht="receiveitemend",ut="additems",dt="removeitems",ft="dragitemstart",mt="dragitemmove",_t="dragitemscroll",ct="dragitemend",pt="releaseitemstart",gt="releaseitemend",yt="destroy";return s.Item=l,s.Drag=f,s.Layout=a,s.AnimateLayout=d,s.AnimateVisibility=d,s.Emitter=u,s.defaultSettings={container:null,items:[],show:{duration:300,easing:"ease",styles:{opacity:1,scale:1}},hide:{duration:300,easing:"ease",styles:{opacity:0,scale:.5}},layout:{fillGaps:!1,horizontal:!1,alignRight:!1,alignBottom:!1},layoutOnResize:100,layoutOnInit:!0,layoutDuration:300,layoutEasing:"ease",dragEnabled:!1,dragContainer:null,dragStartPredicate:null,dragSort:!0,dragSortInterval:50,dragSortPredicate:{threshold:50,action:"move"},dragReleaseDuration:300,dragReleaseEasing:"ease",containerClass:"muuri",itemClass:"muuri-item",itemVisibleClass:"muuri-item-shown",itemHiddenClass:"muuri-item-hidden",itemPositioningClass:"muuri-item-positioning",itemDraggingClass:"muuri-item-dragging",itemReleasingClass:"muuri-item-releasing"},s.prototype.getElement=function(){return this._element},s.prototype.getRect=function(){return{width:this._width,height:this._height,left:this._offset.left,right:this._offset.left+this._width,top:this._offset.top,bottom:this._offset.top+this._height}},s.prototype.getItems=function(t,e){var i,n,o,r,s=this,l=t&&"string"!=typeof t,a=l?v(t)?Array.prototype.slice.call(t):[].concat(t):null,h=l?e:t,u=[];if(h="string"==typeof h?h:null,h||a){for(a=a||s._items,i="active"===h,n="inactive"===h,r=0;r<a.length;r++)o=l?s._getItem(a[r]):a[r],o&&(!h||i&&o._isActive||n&&!o._isActive)&&(u[u.length]=o);return u}return u.concat(s._items)},s.prototype.on=function(t,e){return this._emitter.on(t,e),this},s.prototype.off=function(t,e){return this._emitter.off(t,e),this},s.prototype.refresh=function(){var t,e,i=this,n=i._element,o=["left","right","top","bottom"],r=n.getBoundingClientRect();for(i._offset=i._offset||{},i._border=i._border||{},i._padding=i._padding||{},i._width=Math.round(r.width),i._height=Math.round(r.height),i._offset.left=Math.round(r.left),i._offset.top=Math.round(r.top),e=0;e<o.length;e++)t=o[e],i._border[t]=Math.round(x(n,"border-"+t+"-width")),i._padding[t]=Math.round(x(n,"padding-"+t));return i._boxSizing=S(n,"box-sizing"),i._emitter.emit(K),i},s.prototype.refreshItems=function(t){var e,i=this,n=i.getItems(t||"active");for(e=0;e<n.length;e++)n[e]._refresh();return i._emitter.emit(Z,n),i},s.prototype.addItems=function(t,e){var i,n,o,r=this,l=[].concat(t),a=[],h=r._items,u=!1;for(o=0;o<h.length;o++)i=l.indexOf(h[o]._element),i>-1&&l.splice(i,1);if(!l.length)return a;for(o=0;o<l.length;o++)n=new s.Item(r,l[o]),a[a.length]=n,n._isActive&&(u=!0,n._noLayoutAnimation=!0);return D(h,a,e),r._emitter.emit(ut,a),u&&r.layoutItems(),a},s.prototype.removeItems=function(t,e){var i,n,o=this,r=o.getItems(t),s=[],l=!1;for(n=0;n<r.length;n++)i=r[n],i._isActive&&(l=!0),s[s.length]=i._destroy(e);return o._emitter.emit(dt,s),l&&o.layoutItems(),s},s.prototype.synchronizeItems=function(){var t,e,i,n=this,o=n._element,r=n._items;if(r.length){for(i=0;i<r.length;i++)e=r[i]._element,e.parentNode===o&&(t=t||document.createDocumentFragment(),t.appendChild(e));t&&o.appendChild(t)}return n._emitter.emit($),n},s.prototype.layoutItems=function(t,e){function i(t,e){t||(_[_.length]=e),++f===m&&("function"==typeof h&&h(_),a.emit(et,_))}var n,o,r,l=this,a=l._emitter,h="function"==typeof t?t:e,u=t===!0,d=new s.Layout(l),f=0,m=d.items.length,_=[];if(l._layout=d,a.emit(tt,d.items),d.setHeight&&(l._height=d.height+l._padding.top+l._padding.bottom+l._border.top+l._border.bottom,H(l._element,{height:("border-box"===l._boxSizing?l._height:d.height)+"px"})),d.setWidth&&(l._width=d.width+l._padding.left+l._padding.right+l._border.left+l._border.right,H(l._element,{width:("border-box"===l._boxSizing?l._width:d.width)+"px"})),m)for(r=0;r<d.items.length;r++)n=d.items[r],o=d.slots[n._id],n._left=o.left+l._padding.left,n._top=o.top+l._padding.top,n._drag&&n._drag._drag.isActive?i(!1,n):n._layout(u,i);else i(!0);return l},s.prototype.showItems=function(t,e,i){return V(this,"show",t,e,i),this},s.prototype.hideItems=function(t,e,i){return V(this,"hide",t,e,i),this},s.prototype.moveItem=function(t,e,i){var n,o,r,s=this,l=s._items;return l.length<2?s:(n=s._getItem(t),o=s._getItem(e),r="swap"===i,n&&o&&n!==o&&(r?c(l,l.indexOf(n),l.indexOf(o)):p(l,l.indexOf(n),l.indexOf(o)),s.layoutItems()._emitter.emit(st,n,o,r?"swap":"move")),s)},s.prototype.sendItem=function(t){var e,i,n,o=this,r=o._settings,l=t.target,a=l._settings,h=o._getItem(t.item),u=h._migrate,f=h._element,m=h.isActive(),_=(h.isVisible()||h.isShowing())&&!h.isHiding(),c=!!t.instant,p=t.layoutContainer||document.body,g=t.position,y=o._items.indexOf(h),v="number"==typeof g?g:g?l._items.indexOf(l._getItem(g)):0;return h._stopLayout(!0),h._stopMigrate(!0),o._itemShowHandler.stop(h),o._itemHideHandler.stop(h),h._drag&&h._drag.destroy(),h._animate.destroy(),h._animateChild.destroy(),B(h._visibilityQueue,!0,h),I(f,r.itemClass),I(f,r.itemVisibleClass),I(f,r.itemHiddenClass),X(f,a.itemClass),X(f,_?a.itemVisibleClass:a.itemHiddenClass),o._items.splice(y,1),D(l._items,h,v),h._muuri=l,h._animate=new s.AnimateLayout(h,f),h._animateChild=new s.AnimateVisibility(h,h._child),h._isDefaultAnimate=h._animate instanceof d,h._isDefaultChildAnimate=h._animateChild instanceof d,o._element!==p&&(i=R(f,"x"),n=R(f,"y"),p.appendChild(f),e=M(f,o._element),i+=e.left,n+=e.top,e=M(f,l._element),u.containerDiffX=e.left,u.containerDiffY=e.top,H(f,{transform:"translateX("+i+"px) translateY("+n+"px)"})),H(f,{display:_?"block":"hidden"}),h._child.removeAttribute("style"),_?l._itemShowHandler.start(h,!0):l._itemHideHandler.start(h,!0),h._refresh(),h._drag=a.dragEnabled?new s.Drag(h):null,u.isActive=!0,u.container=p,u.index=v,u.sender=o,o._emitter.emit(lt,h,l,v),l._emitter.emit(at,h,o,v),m&&(o.layoutItems(c),l.layoutItems(c)),o},s.prototype.destroy=function(e){var i,n,o=this,r=o._element,l=o._items.concat(),a=o._emitter;for(o._resizeHandler&&t.removeEventListener("resize",o._resizeHandler),n=0;n<l.length;n++)l[n]._destroy(e);for(I(r,o._settings.containerClass),H(r,{height:""}),a.emit(yt),i=Object.keys(a._events||{}),n=0;n<i.length;n++)a._events[i[n]].length=0;F(o,s)},s.prototype._getItem=function(t){var e,i,n,o,r=this;if(t){if(t instanceof l)return t._muuri===r?t:null;if("number"==typeof t)return e=t>-1?t:r._items.length+t,r._items[e]||null;for(i=null,o=0;o<r._items.length;o++)if(n=r._items[o],n._element===t){i=n;break}return i}return r._items[0]||null},l.prototype.getElement=function(){return this._element},l.prototype.getWidth=function(){return this._width},l.prototype.getHeight=function(){return this._height},l.prototype.getMargin=function(){return{left:this._margin.left,right:this._margin.right,top:this._margin.top,bottom:this._margin.bottom}},l.prototype.getPosition=function(){return{left:this._left,top:this._top}},l.prototype.isActive=function(){return this._isActive},l.prototype.isVisible=function(){return!this._isHidden},l.prototype.isShowing=function(){return this._isShowing},l.prototype.isHiding=function(){return this._isHiding},l.prototype.isPositioning=function(){return this._isPositioning},l.prototype.isDragging=function(){return this._drag&&this._drag._drag.isActive},l.prototype.isReleasing=function(){return this._drag&&this._drag._release.isActive},l.prototype.isMigrating=function(){return this._migrate.isActive},l.prototype._stopLayout=function(t){var e=this,i=e._muuri._settings;return e._isPositioning&&(e._animate.stop(),I(e._element,i.itemPositioningClass),e._isPositioning=!1,t&&B(e._layoutQueue,!0,e)),e},l.prototype._refresh=function(){var t,e,i,n,o,r=this,s=r._element;if(!r._isHidden){for(e=["left","right","top","bottom"],n=r._margin=r._margin||{},o=0;o<4;o++)i=Math.round(x(s,"margin-"+e[o])),n[e[o]]=i>0?i:0;t=s.getBoundingClientRect(),r._width=Math.round(t.width),r._height=Math.round(t.height),r._outerWidth=r._width+n.left+n.right,r._outerHeight=r._height+n.top+n.bottom}return r},l.prototype._layout=function(t,e){var i,o,r,s,l=this,a=l._muuri,h=a._settings,u=l._drag?l._drag._release:{},d=u.isActive&&u.isPositioningStarted===!1,f=d?h.dragReleaseDuration:h.layoutDuration,m=d?h.dragReleaseEasing:h.layoutEasing,_=t!==!0&&!l._noLayoutAnimation&&f>0,c=l._isPositioning,p=l._migrate,g=function(){l._isPositioning&&(l._isPositioning=!1,I(l._element,h.itemPositioningClass)),u.isActive&&l._drag._stopRelease(),p.isActive&&l._stopMigrate(),B(l._layoutQueue,!1,l)};if(c&&B(l._layoutQueue,!0,l),d&&(u.isPositioningStarted=!0),"function"==typeof e&&(l._layoutQueue[l._layoutQueue.length]=e),i=u.isActive?u.containerDiffX:p.isActive?p.containerDiffX:0,o=u.isActive?u.containerDiffY:p.isActive?p.containerDiffY:0,_){if(c&&l._isDefaultAnimate?(r=parseFloat(n.hook(l._element,"translateX"))-i,s=parseFloat(n.hook(l._element,"translateY"))-o):(r=R(l._element,"x")-i,s=R(l._element,"y")-o),l._left===r&&l._top===s)return l._stopLayout(),void g();c||(l._isPositioning=!0,X(l._element,h.itemPositioningClass)),l._animate.start({translateX:r+i+"px",translateY:s+o+"px"},{translateX:l._left+i,translateY:l._top+o},{duration:f,easing:m,done:g})}else l._stopLayout(),l._noLayoutAnimation=!1,u.isActive&&u.element.parentNode!==a._element&&p.isActive&&p.container!==a._element||H(l._element,{transform:"translateX("+(l._left+i)+"px) translateY("+(l._top+o)+"px)"}),g();return l},l.prototype._show=function(t,e){var i=this,n=i._muuri._settings;return i._isHidden||i._isShowing?i._isHidden?(i._isHiding&&i._muuri._itemHideHandler.stop(i),i._isActive=i._isShowing=!0,i._isHidden=i._isHiding=!1,X(i._element,n.itemVisibleClass),I(i._element,n.itemHiddenClass),H(i._element,{display:"block"}),B(i._visibilityQueue,!0,i),"function"==typeof e&&(i._visibilityQueue[i._visibilityQueue.length]=e),i._muuri._itemShowHandler.start(i,t,function(){B(i._visibilityQueue,!1,i)})):"function"==typeof e&&(i._visibilityQueue[i._visibilityQueue.length]=e):"function"==typeof e&&e(!1,i),i},l.prototype._hide=function(t,e){var i=this,n=i._muuri._settings;return i._isHidden&&!i._isHiding?"function"==typeof e&&e(!1,i):i._isHidden?"function"==typeof e&&(i._visibilityQueue[i._visibilityQueue.length]=e):(i._isShowing&&i._muuri._itemShowHandler.stop(i),i._isHidden=i._isHiding=!0,i._isActive=i._isShowing=!1,X(i._element,n.itemHiddenClass),I(i._element,n.itemVisibleClass),B(i._visibilityQueue,!0,i),"function"==typeof e&&(i._visibilityQueue[i._visibilityQueue.length]=e),i._muuri._itemHideHandler.start(i,t,function(){H(i._element,{display:"none"}),B(i._visibilityQueue,!1,i)})),i},l.prototype._stopMigrate=function(t){var e,i,n,o,r=this,s=r._muuri,l=r._migrate;l.isActive&&(l.container!==s._element&&(e=t?R(r._element,"x")-l.containerDiffX:r._left,i=t?R(r._element,"y")-l.containerDiffY:r._top,s._element.appendChild(r._element),H(r._element,{transform:"translateX("+e+"px) translateY("+i+"px)"})),t||(n=l.sender,o=l.index),l.isActive=!1,l.container=null,l.containerDiffX=0,l.containerDiffY=0,l.sender=null,l.index=0,t||s._emitter.emit(ht,r,n,o))},l.prototype._destroy=function(t){var e=this,i=e._muuri,n=i._settings,o=e._element,r=i._items.indexOf(e);e._stopLayout(!0),i._itemShowHandler.stop(e),i._itemHideHandler.stop(e),e._stopMigrate(!0),e._drag&&e._drag.destroy(),e._animate.destroy(),e._animateChild.destroy(),o.removeAttribute("style"),e._child.removeAttribute("style"),B(e._visibilityQueue,!0,e),I(o,n.itemPositioningClass),I(o,n.itemDraggingClass),I(o,n.itemReleasingClass),I(o,n.itemClass),I(o,n.itemVisibleClass),I(o,n.itemHiddenClass),r>-1&&i._items.splice(r,1),t&&o.parentNode.removeChild(o),F(e,l)},h.getSlot=function(t,e,i,n,o,r){var s,l,a,u,d,f=e[0]||[],m=[],_={left:null,top:null,width:i,height:n};for(u=0;u<f.length;u++)if(s=f[u],_.width<=s.width&&_.height<=s.height){_.left=s.left,_.top=s.top;break}for(null===_.left&&(_.left=o?0:t.width,_.top=o?t.height:0,r||(a=!0)),o&&_.top+_.height>t.height&&(_.left>0&&(m[m.length]={left:0,top:t.height,width:_.left,height:1/0}),_.left+_.width<t.width&&(m[m.length]={left:_.left+_.width,top:t.height,width:t.width-_.left-_.width,height:1/0}),t.height=_.top+_.height),!o&&_.left+_.width>t.width&&(_.top>0&&(m[m.length]={left:t.width,top:0,width:1/0,height:_.top}),_.top+_.height<t.height&&(m[m.length]={left:t.width,top:_.top+_.height,width:1/0,height:t.height-_.top-_.height}),t.width=_.left+_.width),u=r?0:a?f.length:u;u<f.length;u++)for(l=h.splitRect(f[u],_),d=0;d<l.length;d++)s=l[d],s.width>0&&s.height>0&&(o&&s.top<t.height||!o&&s.left<t.width)&&(m[m.length]=s);return h.purgeSlots(m).sort(o?h.sortRectsTopLeft:h.sortRectsLeftTop),e[0]=m,_},h.sortRectsTopLeft=function(t,e){return t.top<e.top?-1:t.top>e.top?1:t.left<e.left?-1:t.left>e.left?1:0},h.sortRectsLeftTop=function(t,e){return t.left<e.left?-1:t.left>e.left?1:t.top<e.top?-1:t.top>e.top?1:0},h.isRectWithinRect=function(t,e){return t.left>=e.left&&t.top>=e.top&&t.left+t.width<=e.left+e.width&&t.top+t.height<=e.top+e.height},h.purgeSlots=function(t){for(var e,i,n,o=t.length;o--;)for(i=t[o],e=t.length;e--;)if(n=t[e],o!==e&&h.isRectWithinRect(i,n)){t.splice(o,1);break}return t},h.splitRect=function(t,e){var i=[],n=!(e.left>t.left+t.width||e.left+e.width<t.left||e.top>t.top+t.height||e.top+e.height<t.top);return n?(t.left<e.left&&(i[i.length]={left:t.left,top:t.top,width:e.left-t.left,height:t.height}),t.left+t.width>e.left+e.width&&(i[i.length]={left:e.left+e.width,top:t.top,width:t.left+t.width-(e.left+e.width),height:t.height}),t.top<e.top&&(i[i.length]={left:t.left,top:t.top,width:t.width,height:e.top-t.top}),t.top+t.height>e.top+e.height&&(i[i.length]={left:t.left,top:e.top+e.height,width:t.width,height:t.top+t.height-(e.top+e.height)})):i[0]=t,i},u.prototype.on=function(t,e){var i=this._events=this._events||{},n=i[t]||[];return n[n.length]=e,i[t]=n,this},u.prototype.off=function(t,e){var n=this._events=this._events||{},o=n[t]||[],r=o.length;if(r)for(;r--;)e===o[i]&&o.splice(r,1);return this},u.prototype.emit=function(t,e,i,n){var o,r,s=this._events=this._events||{},l=s[t]||[],a=l.length;if(a)for(o=arguments.length-1,l=l.concat(),r=0;r<a;r++)0===o?l[r]():1===o?l[r](e):2===o?l[r](e,i):l[r](e,i,n);return this},d.prototype.start=function(t,e,i){var o=this,r=i||{},s="function"==typeof r.done?r.done:null,l={duration:r.duration||300,delay:r.delay||0,easing:r.easing||"ease",queue:o._queue};o._isAnimating&&o.stop(),t&&E(o._element,t),o._isAnimating=!0,s&&(l.complete=function(){s()}),n(o._element,e,l),n.Utilities.dequeue(o._element,o._queue)},d.prototype.stop=function(){this._isAnimating&&(this._isAnimating=!1,n(this._element,"stop",this._queue))},d.prototype.destroy=function(){this.stop(),F(this,d)},f.defaultStartPredicate=function(t,e,i){i.resolve()},f.defaultSortPredicate=function(t){var e,i,n,o,r=t._muuri,s=r._settings,l=s.dragSortPredicate||{},a=l.threshold||50,h=l.action||"move",u=r._items,d=t._drag,f={width:d._item._width,height:d._item._height,left:Math.round(d._drag.gridX)+d._item._margin.left,top:Math.round(d._drag.gridY)+d._item._margin.top},m=0,_=null;for(o=0;o<u.length;o++)n=u[o],n===t?m=o:n._isActive&&(i=W(f,{width:n._width,height:n._height,left:Math.round(n._left)+n._margin.left,top:Math.round(n._top)+n._margin.top}),(null===_||i>_)&&(_=i,e=o));return null!==_&&_>=a&&{action:h,from:m,to:e}},f.prototype.destroy=function(){var t=this;return t._drag.isActive?t._stopDrag():t._release.isActive&&t._stopRelease(!0),t._hammer.destroy(),Q(t._item._element),Q(t._item._child),F(t,f),t},f.prototype._setupDragData=function(){var t=this._drag=this._drag||{};return t.isActive=!1,t.startEvent=null,t.currentEvent=null,t.elementStyles=null,t.scrollParents=[],t.left=0,t.top=0,t.gridX=0,t.gridY=0,t.elementClientX=0,t.elementClientY=0,t.containerDiffX=0,t.containerDiffY=0,t},f.prototype._setupReleaseData=function(){var t=this._release=this._release||{};return t.isActive=!1,t.isPositioningStarted=!1,t.containerDiffX=0,t.containerDiffY=0,t.element=null,t.elementStyles=null,t},f.prototype._checkOverlap=function(){var t=this,e=t._sortPredicate(t._item);e&&t._item._muuri.moveItem(e.from,e.to,e.action||"move")},f.prototype._freezeElement=function(t){var e,i,n;if(!t.elementStyles)for(e=["width","height","padding","margin"],t.elementStyles={},n=0;n<4;n++)i=e[n],t.elementStyles[i]=t.element.style[i]||"",t.element.style[i]=S(t.element,i)},f.prototype._unfreezeElement=function(t){var e,i,n;if(t.elementStyles){for(e=Object.keys(t.elementStyles),n=0;n<e.length;n++)i=e[n],t.element.style[i]=t.elementStyles[i];t.elementStyles=null}},f.prototype._stopDrag=function(){var t,e=this,i=e._item,n=e._drag,o=i._muuri,r=i._muuri._settings;if(n.isActive){for(t=0;t<n.scrollParents.length;t++)n.scrollParents[t].removeEventListener("scroll",e._scrollHandler);e._checkSortOverlap("cancel"),n.element.parentNode!==o._element&&(o._element.appendChild(n.element),H(n.element,{transform:"translateX("+n.gridX+"px) translateY("+n.gridY+"px)"})),I(n.element,r.itemDraggingClass),e._unfreezeElement(n),e._setupDragData()}},f.prototype._startRelease=function(){var t=this,e=t._item,i=e._muuri,n=i._settings,o=t._release;o.isActive||(o.isActive=!0,X(o.element,n.itemReleasingClass),i._emitter.emit(pt,e),e._layout(!1))},f.prototype._stopRelease=function(t){var e,i,n=this,o=n._item,r=o._muuri,s=r._settings,l=n._release;l.isActive&&(I(l.element,s.itemReleasingClass),l.element.parentNode!==r._element&&(e=t?R(l.element,"x")-l.containerDiffX:o._left,i=t?R(l.element,"y")-l.containerDiffY:o._top,r._element.appendChild(l.element),H(l.element,{transform:"translateX("+e+"px) translateY("+i+"px)"})),n._unfreezeElement(l),n._setupReleaseData(),t||r._emitter.emit(gt,o))},f.prototype._onDragStart=function(t){var e,i,n,o,r,s,l,a=this,h=a._item,u=h._muuri,d=u._settings,f=a._drag,m=a._release;if(h._isActive){for(h._isPositioning&&h._stopLayout(!0),h._migrate.isActive&&h._stopMigrate(!0),m.isActive&&(f.elementStyles=m.elementStyles,I(h._element,d.itemReleasingClass),a._setupReleaseData()),f.isActive=!0,f.startEvent=t,f.currentEvent=t,f.element=h._element,e=R(f.element,"x"),i=R(f.element,"y"),n=u._element,o=d.dragContainer,f.left=f.gridX=e,f.top=f.gridY=i,o&&o!==n&&(f.element.parentNode===o?(r=M(f.element,n),f.containerDiffX=r.left,f.containerDiffY=r.top,f.gridX=e-f.containerDiffX,f.gridY=i-f.containerDiffY):(a._freezeElement(f),o.appendChild(f.element),r=M(f.element,n),f.containerDiffX=r.left,f.containerDiffY=r.top,f.left=e+f.containerDiffX,f.top=i+f.containerDiffY,H(f.element,{transform:"translateX("+f.left+"px) translateY("+f.top+"px)"}))),s=f.element.getBoundingClientRect(),f.elementClientX=s.left,f.elementClientY=s.top,f.scrollParents=O(f.element),o&&o!==n&&(f.scrollParents=g(f.scrollParents.concat(O(n)))),l=0;l<f.scrollParents.length;l++)f.scrollParents[l].addEventListener("scroll",a._scrollHandler);X(f.element,d.itemDraggingClass),u._emitter.emit(ft,h,t)}},f.prototype._onDragMove=function(t){var e,i,n=this,o=n._item,r=o._muuri,s=r._settings,l=n._drag;return o._isActive?(e=t.deltaX-l.currentEvent.deltaX,i=t.deltaY-l.currentEvent.deltaY,l.currentEvent=t,l.left+=e,l.top+=i,l.gridX+=e,l.gridY+=i,l.elementClientX+=e,l.elementClientY+=i,H(l.element,{transform:"translateX("+l.left+"px) translateY("+l.top+"px)"}),s.dragSort&&n._checkSortOverlap(),void r._emitter.emit(mt,o,t)):void n._stopDrag()},f.prototype._onDragScroll=function(){var t,e=this,i=e._item,n=i._muuri,o=n._settings,r=e._drag,s=n._element,l=o.dragContainer,a=r.element.getBoundingClientRect(),h=r.elementClientX-a.left,u=r.elementClientY-a.top;l&&l!==s&&(t=M(r.element,s),r.containerDiffX=t.left,r.containerDiffY=t.top),r.left+=h,r.top+=u,r.gridX=r.left-r.containerDiffX,r.gridY=r.top-r.containerDiffY,H(r.element,{transform:"translateX("+r.left+"px) translateY("+r.top+"px)"}),o.dragSort&&e._checkSortOverlap(),n._emitter.emit(_t,i)},f.prototype._onDragEnd=function(t){var e,i=this,n=i._item,o=n._muuri,r=o._settings,s=i._drag,l=i._release;if(!n._isActive)return void i._stopDrag();for(r.dragSort&&i._checkSortOverlap("finish"),e=0;e<s.scrollParents.length;e++)s.scrollParents[e].removeEventListener("scroll",i._scrollHandler);I(s.element,r.itemDraggingClass),o._emitter.emit(ct,n,t),l.containerDiffX=s.containerDiffX,l.containerDiffY=s.containerDiffY,l.element=s.element,l.elementStyles=s.elementStyles,i._setupDragData(),i._startRelease()},m.prototype.isResolved=function(){return this._isResolved},m.prototype.isRejected=function(){return this._isRejected},m.prototype.resolve=function(){this._isRejected||this._isResolved||(this._isResolved=!0,"function"==typeof this._onResolved&&this._onResolved.call(this),this._onResolved=this._onRejected=null)},m.prototype.reject=function(){this._isRejected||this._isResolved||(this._isRejected=!0,"function"==typeof this._onRejected&&this._onRejected.call(this),this._onResolved=this._onRejected=null)},s});