/*!
 * Muuri v0.3.0-dev
 * https://github.com/haltu/muuri
 * Copyright (c) 2015, Haltu Oy
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
!function(t,e){var i="Muuri",n=t.mezr,s=t.Hammer;t[i]=e(t,n,s)}(this,function(t,e,n,s){"use strict";function o(){}function r(t){this._element=t,this._isAnimating=!1,this._animatedStyles=[],this._callback=null}function a(t){var e=this,i=[],n=!!t.fillGaps,s=!!t.horizontal,o=!!t.alignRight,r=!!t.alignBottom;e.width=Math.round(e.width),e.height=Math.round(e.height),s?(e.setWidth=!0,e.width=0):(e.setHeight=!0,e.height=0),e.items.length&&(e.items.forEach(function(t){var o=a.getSlot(e,i,t._width,t._height,!s,n);s?e.width=Math.max(e.width,o.left+o.width):e.height=Math.max(e.height,o.top+o.height),e.slots[t._id]=o}),(o||r)&&Object.keys(e.slots).forEach(function(t){var i=e.slots[t];o&&(i.left=e.width-(i.left+i.width)),r&&(i.top=e.height-(i.top+i.height))}))}function l(e){var i,n=this,s=n._settings=f({},l.defaultSettings,e||{});if(!document.body.contains(s.container))throw new Error("Container must be an existing DOM element");n._element=s.container,w(s.container,s.containerClass),n._id=++H,n._animQueue="muuri-"+n._id,n._emitter=new o,n._itemShow="function"==typeof s.show?s.show():k("show",s.show),n._itemHide="function"==typeof s.hide?s.hide():k("hide",s.hide),n._dragSort="function"==typeof s.dragSortPredicate?s.dragSortPredicate:X,n._items=Array.prototype.slice.call(s.items).map(function(t){return new l.Item(n,t)}),(s.layoutOnResize||0===s.layoutOnResize)&&(i=_(function(){n.refresh(),n.layout()},s.layoutOnResize),n._resizeHandler=function(){i()},t.addEventListener("resize",n._resizeHandler)),s.layoutOnInit&&n.layout(!0)}function h(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function u(t,e,i){t.splice(i,0,t.splice(e,1)[0])}function m(t){var e=[];return t.forEach(function(t){e.indexOf(t)<0&&e.push(t)}),e}function c(t){return"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)}function f(t){var e,i=arguments.length;for(e=1;e<i;e++)Object.keys(arguments[e]).forEach(function(e){"styles"!==e&&c(t[e])&&c(this[e])?f(t[e],this[e]):t[e]=this[e]},arguments[e]);return t}function _(e,i){var n,o="cancel",r="finish";return function(a){n!==s&&(n=t.clearTimeout(n),a===r&&e()),a!==o&&a!==r&&(n=t.setTimeout(function(){n=s,e()},i))}}function d(e,i){return i="transform"===i?N.styleName||i:"transition"===i?z.styleName||i:i,t.getComputedStyle(e,null).getPropertyValue(i)}function p(t,e){return parseFloat(d(t,e))||0}function g(t,e){return parseFloat((d(t,"transform")||"").replace("matrix(","").split(",")["x"===e?4:5])||0}function y(t,e){Object.keys(e).forEach(function(i){var n=e[i],s="transform"===i?N.propName||i:"transition"===i?z.propName||i:i;t.style[s]=n})}function v(t,e){return(" "+t.className).indexOf(" "+e)>-1}function w(t,e){t.classList?t.classList.add(e):v(t,e)&&(t.className+=" "+e)}function D(t,e){t.classList?t.classList.remove(e):v(t,e)&&(t.className=(" "+t.className+" ").replace(" "+e+" "," ").trim())}function C(t){var e,i,n,o=document.documentElement,r=t.charAt(0).toUpperCase()+t.slice(1),a=["","Webkit","Moz","O","ms"];for(n=0;n<a.length;n++)if(e=a[n],i=e?e+r:t,o.style[i]!==s)return e=e.toLowerCase(),{prefix:e,propName:i,styleName:e?"-"+e+"-"+t:t};return null}function S(t){var e=d(t,"transform"),i=d(t,"display");return"none"!==e&&"inline"!==i&&"none"!==i}function b(t,i){return e.offset([i,"padding"],[e.containingBlock(t)||document,"padding"])}function E(i){var n=[],s=/(auto|scroll)/,o=i.parentNode;if(e._settings.transformLeaksFixed){if("fixed"===d(i,"position"))return n;for(;o&&o!==document&&o!==document.documentElement;)s.test(d(o,"overflow")+d(o,"overflow-y")+d(o,"overflow-x"))&&n.push(o),o="fixed"===d(o,"position")?null:o.parentNode;null!==o&&n.push(t)}else{for(;o&&o!==document;)"fixed"!==d(i,"position")||S(o)?(s.test(d(o,"overflow")+d(o,"overflow-y")+d(o,"overflow-x"))&&n.push(o),i=o,o=o.parentNode):o=o.parentNode;n.length&&n[n.length-1]===document.documentElement&&(n[n.length-1]=t)}return n}function x(t,i){var n={intersection:e.intersection(t,i),score:0};if(!n.intersection)return n;var s={width:t.width,height:t.height,left:0,top:0},o={width:i.width,height:i.height,left:0,top:0},r=e.intersection(s,o);return n.score=n.intersection.width*n.intersection.height/(r.width*r.height)*100,n}function I(t,e,i){return{type:t,event:e,currentLeft:i.left,currentTop:i.top,gridLeft:i.gridX,gridTop:i.gridY}}function O(t,e,i){this.isResolved||(this.isResolved=!0,i(t))}function R(t){t.elementStyles||(t.elementStyles={},["width","height","padding","margin"].forEach(function(e){t.elementStyles[e]=t.element.style[e]||"",t.element.style[e]=d(t.element,e)}))}function A(t){t.elementStyles&&Object.keys(t).forEach(function(e){t.element.style[e]=t.elementStyles[e]})}function L(t,e,i,n,s){var o,r,a=t.get(i),l="function"==typeof n?n:s,h=a.length,u="show"===e,m=u?q:B,c=u?W:G,f=n===!0,_=!1;h?(o=[],r=[],t._emitter.emit(m,a),a.forEach(function(i){(u&&!i._isActive||!u&&i._isActive)&&(_=!0,u&&(i._noLayoutAnimation=!0,r.push(i))),i["_"+e](f,function(e,i){e||o.push(i),--h<1&&("function"==typeof l&&l(o),t._emitter.emit(c,o))})}),_&&(r.length&&t.refresh(r),t.layout())):"function"==typeof s&&s(a)}function k(t,e){var i=parseInt(e&&e.duration)||0,n=i>0,s=e&&e.easing||"ease",o=e&&c(e.styles)?e.styles:null;return{styles:o,start:function(t,e,r){n&&o?e?(y(t._child,o),r()):t._animateChild.start(o,{duration:i,easing:s,done:r}):r()},stop:function(t){t._animateChild.stop()}}}function P(t,e,i){t.splice(0,t.length).forEach(function(t){t(e,i)})}function X(t){var e,i=t._muuri,n=i._settings,s=n.dragSortPredicate||{},o=s.tolerance||50,r=s.action||"move",a=i._items,l=t._drag,h={width:l.item._width-l.item._margin.left-l.item._margin.right,height:l.item._height-l.item._margin.top-l.item._margin.bottom,left:l.gridX+l.item._margin.left,top:l.gridY+l.item._margin.top},u=0,m=null;return a.forEach(function(i,n){var s,o;i===t?u=n:i._isActive&&(s={width:i._width-i._margin.left-i._margin.right,height:i._height-i._margin.top-i._margin.bottom,left:i._left+i._margin.left,top:i._top+i._margin.top},o=x(h,s),(null===m||o.score>m)&&(m=o.score,e=n))}),null!==m&&m>=o&&{action:r,from:u,to:e}}var Y="Muuri";if(!e)throw Error("["+Y+"] required dependency mezr is not defined.");var H=0,N=C("transform"),z=C("transition"),M=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||t.oRequestAnimationFrame||null,j="refresh",Q="synchronize",F="layoutstart",T="layoutend",q="showstart",W="showend",B="hidestart",G="hideend",U="move",V="swap",J="add",K="remove",Z="dragstart",$="dragmove",tt="dragscroll",et="dragend",it="releasestart",nt="releaseend",st="destroy";return o.prototype.on=function(t,e){var i=this._events=this._events||{},n=i[t]||[];return n.push(e),i[t]=n,this},o.prototype.off=function(t,e){var n=this._events=this._events||{},s=n[t]||[],o=s.length;if(o)for(;o--;)e===s[i]&&s.splice(o,1);return this},o.prototype.emit=function(t,e,i,n){var s,o,r=this._events=this._events||{},a=r[t]||[],l=a.length;if(l)for(s=arguments.length-1,a=a.concat(),o=0;o<l;o++)0===s?a[o]():1===s?a[o](e):2===s?a[o](e,i):a[o](e,i,n);return this},r.prototype.start=function(t,e){var i=this,n=i._element,s=t||{},o=e||{},r=o.done,a=Object.keys(s),l={transitionProperty:a.join(","),transitionDuration:(o.duration||400)+"ms",transitionDelay:(o.delay||0)+"ms",transitionEasing:o.easing||"ease"};i.stop(),i._animatedStyles=a,i._isAnimating=!0,i._callback=function(t){t.target===n&&(i.stop(),"function"==typeof r&&r())},n.addEventListener("transitionend",i._callback,!0),n.offsetWidth,y(n,l),y(n,s)},r.prototype.stop=function(){var t=this,e={};t._isAnimating&&("function"==typeof t._callback&&(t._element.removeEventListener("transitionend",t._callback,!0),t._callback=null),t._animatedStyles.forEach(function(i){e[i]=d(t._element,i)}),e.transitionProperty="",e.transitionDuration="",e.transitionDelay="",e.transitionEasing="",y(t._element,e),t._isAnimating=!1)},r.prototype.isAnimating=function(){return this._isAnimating},r.prototype.destroy=function(){this.stop(),this._element=null,this._isAnimating=null,this._animatedStyles=null,this._callback=null},a.getSlot=function(t,e,i,n,s,o){var r,l,h,u,m,c=e[0]||[],f=[],_={left:null,top:null,width:i,height:n};for(u=0;u<c.length;u++)if(r=c[u],_.width<=r.width&&_.height<=r.height){_.left=r.left,_.top=r.top;break}for(null===_.left&&(_.left=s?0:t.width,_.top=s?t.height:0,o||(h=!0)),s&&_.top+_.height>t.height&&(_.left>0&&f.push({left:0,top:t.height,width:_.left,height:1/0}),_.left+_.width<t.width&&f.push({left:_.left+_.width,top:t.height,width:t.width-_.left-_.width,height:1/0}),t.height=_.top+_.height),!s&&_.left+_.width>t.width&&(_.top>0&&f.push({left:t.width,top:0,width:1/0,height:_.top}),_.top+_.height<t.height&&f.push({left:t.width,top:_.top+_.height,width:1/0,height:t.height-_.top-_.height}),t.width=_.left+_.width),u=o?0:h?c.length:u;u<c.length;u++)for(l=a.splitRect(c[u],_),m=0;m<l.length;m++)r=l[m],r.width>0&&r.height>0&&(s&&r.top<t.height||!s&&r.left<t.width)&&f.push(r);return a.purgeSlots(f).sort(s?a.sortRectsTopLeft:a.sortRectsLeftTop),e[0]=f,_},a.sortRectsTopLeft=function(t,e){return t.top<e.top?-1:t.top>e.top?1:t.left<e.left?-1:t.left>e.left?1:0},a.sortRectsLeftTop=function(t,e){return t.left<e.left?-1:t.left>e.left?1:t.top<e.top?-1:t.top>e.top?1:0},a.isRectWithinRect=function(t,e){return t.left>=e.left&&t.top>=e.top&&t.left+t.width<=e.left+e.width&&t.top+t.height<=e.top+e.height},a.purgeSlots=function(t){for(var e,i,n,s=t.length;s--;)for(i=t[s],e=t.length;e--;)if(n=t[e],s!==e&&a.isRectWithinRect(i,n)){t.splice(s,1);break}return t},a.splitRect=function(t,e){var i=[],n=!(e.left>t.left+t.width||e.left+e.width<t.left||e.top>t.top+t.height||e.top+e.height<t.top);return n?(t.left<e.left&&i.push({left:t.left,top:t.top,width:e.left-t.left,height:t.height}),t.left+t.width>e.left+e.width&&i.push({left:e.left+e.width,top:t.top,width:t.left+t.width-(e.left+e.width),height:t.height}),t.top<e.top&&i.push({left:t.left,top:t.top,width:t.width,height:e.top-t.top}),t.top+t.height>e.top+e.height&&i.push({left:t.left,top:e.top+e.height,width:t.width,height:t.top+t.height-(e.top+e.height)})):i[0]=t,i},l.prototype._getItem=function(t){var e,i,n,s;if(t){if(t instanceof l.Item)return t._muuri===this?t:null;if("number"==typeof t)return e=t>-1?t:this._items.length+t,this._items[e]||null;for(i=null,s=0;s<this._items.length;s++)if(n=this._items[s],n._element===t){i=n;break}return i}return this._items[0]||null},l.prototype.on=function(t,e){return this._emitter.on(t,e),this},l.prototype.off=function(t,e){return this._emitter.off(t,e),this},l.prototype.refresh=function(t){var e=this.get(t||"active");e.forEach(function(t){t._refresh()}),this._emitter.emit(j,e)},l.prototype.get=function(t,e){var i=t&&"string"!=typeof t,n=i?[].concat(t):null,s=i?e:t,o=[];return s="string"==typeof s?s:null,s||n?((n||this._items).forEach(function(t){var e=i?this._getItem(t):t;e&&(!s||"active"===s&&e._isActive||"inactive"===s&&!e._isActive)&&o.push(e)},this),o):o.concat(this._items)},l.prototype.add=function(t,e){var i=[],n=!1;return t=[].concat(t),this._items.forEach(function(e){var i=t.indexOf(e._element);i>-1&&t.splice(i,1)}),t.length?(t.forEach(function(t){var e=new l.Item(this,t);i.push(e),e._isActive&&(n=!0,e._noLayoutAnimation=!0)},this),e="number"==typeof e?e:-1,e=e<0?this._items.length-e+1:e,this._items.splice.apply(this._items,[e,0].concat(i)),n&&this.layout(),this._emitter.emit(J,i),i):i},l.prototype.remove=function(t,e){var i=[],n=!1;return this.get(t).forEach(function(t){t._isActive&&(n=!0),i.push(t._destroy(e))}),n&&this.layout(),this._emitter.emit(K,i),i},l.prototype.synchronize=function(){this._items.forEach(function(t){t._element.parentNode===this._element&&this._element.appendChild(t._element)},this),this._emitter.emit(Q)},l.prototype.layout=function(t,e){var i=this,n=i._emitter,s="function"==typeof t?t:e,o=t===!0,r=new l.Layout(i),a=-1,h=r.items.length,u=[],m=function(t,e){t||u.push(e),++a===h&&("function"==typeof s&&s(u,r),n.emit(T,u,r))};n.emit(F,r.items,r),r.setHeight&&y(i._element,{height:r.height+"px"}),r.setWidth&&y(i._element,{width:r.width+"px"}),h?r.items.forEach(function(t){var e=r.slots[t._id];t._left=e.left,t._top=e.top,t._drag.active?m(!1,t):t._layout(o,m)}):m(!0)},l.prototype.show=function(t,e,i){L(this,"show",t,e,i)},l.prototype.hide=function(t,e,i){L(this,"hide",t,e,i)},l.prototype.indexOf=function(t){var e,i;if("number"==typeof t)return t<=this._items.length-1?t:-1;if(t instanceof l.Item)return this._items.indexOf(t);for(e=0,i=this._items.length;e<i;e++)if(this._items[e]._element===t)return e;return-1},l.prototype.move=function(t,e){t=this._getItem(t),e=this._getItem(e),t&&e&&t!==e&&(u(this._items,this._items.indexOf(t),this._items.indexOf(e)),this._emitter.emit(U,t,e))},l.prototype.swap=function(t,e){t=this._getItem(t),e=this._getItem(e),t&&e&&t!==e&&(h(this._items,this._items.indexOf(t),this._items.indexOf(e)),this._emitter.emit(V,t,e))},l.prototype.destroy=function(){this._resizeHandler&&t.removeEventListener("resize",this._resizeHandler),this._items.concat().forEach(function(t){t._destroy()}),D(this._element,this._settings.containerClass),y(this._element,{height:""}),this._emitter.emit(st),this._emitter._events&&Object.keys(this._emitter._events).forEach(function(t){this._emitter._events[t].length=0},this),Object.keys(this).concat(Object.keys(l.prototype)).forEach(function(t){this[t]=null},this)},l.Item=function(t,e){var i,n,s=t._settings;if(e.contains(t._element))throw new Error("Item element must not be a parent of the grid container element");e.parentNode!==t._element&&t._element.appendChild(e),i="none"===d(e,"display"),this._id=++H,this._muuri=t,this._element=e,this._child=e.children[0],this._animate=new r(e),this._animateChild=new r(this._child),w(e,s.itemClass),this._isActive=!i,this._isPositioning=!1,this._isHidden=i,this._isHiding=!1,this._isShowing=!1,this._visibilityQueue=[],this._layoutQueue=[],y(this._element,{left:"0",top:"0",transform:"translateX(0px) translateY(0px)"}),w(e,i?s.hiddenClass:s.shownClass),n=t[i?"_itemHide":"_itemShow"].styles,n&&y(this._child,n),i||y(this._element,{display:"block"}),this._refresh(),this._left=0,this._top=0,this._drag={active:!1},this._release={active:!1},t._settings.dragEnabled&&this._initDrag()},l.Item.prototype.inspect=function(){return{element:this._element,width:this._width,height:this._height,margin:{left:this._margin.left,top:this._margin.top,right:this._margin.right,bottom:this._margin.bottom},left:this._left,top:this._top,active:this._isActive,positioning:this._isPositioning,dragging:this._drag.active,releasing:this._release.active,visibility:this._isHiding?"hiding":this._isShowing?"showing":this._isHidden?"hidden":"shown"}},l.Item.prototype._initDrag=function(){if(!n)throw Error("["+Y+"] required dependency Hammer is not defined.");var t=this,e=t._muuri._settings,i=t._drag,s=!1,o=t._hammer=new n.Manager(t._element);o.add(new n.Pan({event:"drag",pointers:1,threshold:0,direction:n.DIRECTION_ALL})),o.add(new n.Press({event:"draginit",pointers:1,threshold:100,time:0})),o.set({touchAction:"none"}),t._resetReleaseData(),t._resetDragData(),i.checkOverlap=_(function(){i.active&&t._checkOverlap()},e.dragSortInterval),i.predicate="function"==typeof e.dragPredicate?e.dragPredicate:O,i.predicateData={},i.isPredicateResolved=function(){return s},i.resolvePredicate=function(e){s||"draginitup"===e.type||"dragend"===e.type||"dragcancel"===e.type||(s=!0,t._onDragStart(e))},i.onScroll=function(e){M?M(function(){t._onDragScroll(e)}):t._onDragScroll(e)},o.on("draginit",function(e){i.predicateData={},s=!1,i.predicate.call(i.predicateData,e,t,i.resolvePredicate)}).on("dragstart dragmove",function(e){s&&i.active&&t._onDragMove(e),i.predicate.call(i.predicateData,e,t,i.resolvePredicate)}).on("dragend dragcancel draginitup",function(e){s&&i.active&&t._onDragEnd(e),i.predicate.call(i.predicateData,e,t,i.resolvePredicate)})},l.Item.prototype._resetDragData=function(){var t=this._drag;t.active=!1,t.start=null,t.lastMove=null,t.move=null,t.item=null,t.element=null,t.elementStyles=null,t.scrollParents=[],t.left=0,t.top=0,t.gridX=0,t.gridY=0,t.elemClientX=0,t.elemClientY=0,t.containerDiffX=0,t.containerDiffY=0},l.Item.prototype._onDragStart=function(t){var e,i,n,s,o,r,a=this._drag,l=this._muuri._settings,h=this._release.active;this._isActive&&(this._isPositioning&&this._stopLayout(),h&&(a.elementStyles=this._release.elementStyles,D(this._element,l.releasingClass),this._resetReleaseData()),a.active=!0,a.start=t,a.lastMove=t,a.move=t,a.item=this,a.element=this._element,e=g(a.element,"x"),i=g(a.element,"y"),n=this._muuri._element,s=l.dragContainer,a.left=a.gridX=e,a.top=a.gridY=i,s&&s!==n&&(a.element.parentNode===s?(o=b(a.element,n),a.containerDiffX=o.left,a.containerDiffY=o.top,a.gridX=e-a.containerDiffX,a.gridY=i-a.containerDiffY):(R(a),s.appendChild(a.element),o=b(a.element,n),a.containerDiffX=o.left,a.containerDiffY=o.top,a.left=e+a.containerDiffX,a.top=i+a.containerDiffY,y(a.element,{transform:"translateX("+a.left+"px) translateY("+a.top+"px)"}))),r=a.element.getBoundingClientRect(),a.elemClientX=r.left,a.elemClientY=r.top,a.scrollParents=E(a.element),s&&s!==n&&(a.scrollParents=m(a.scrollParents.concat(E(n)))),a.scrollParents.forEach(function(t){t.addEventListener("scroll",a.onScroll)}),w(a.element,l.draggingClass),this._muuri._emitter.emit(Z,this,I("dragstart",t,a)))},l.Item.prototype._onDragMove=function(t){var e,i,n=this._drag,s=this._muuri._settings;return this._isActive?(e=t.deltaX-n.move.deltaX,i=t.deltaY-n.move.deltaY,n.lastMove=n.move,n.move=t,n.left+=e,n.top+=i,n.gridX+=e,n.gridY+=i,n.elemClientX+=e,n.elemClientY+=i,y(n.element,{transform:"translateX("+n.left+"px) translateY("+n.top+"px)"}),s.dragSort&&n.checkOverlap(),void this._muuri._emitter.emit($,this,I("dragmove",t,n))):void this._resetDrag()},l.Item.prototype._onDragScroll=function(t){var e,i=this._drag,n=this._muuri._settings,s=this._muuri._element,o=n.dragContainer,r=i.element.getBoundingClientRect(),a=i.elemClientX-r.left,l=i.elemClientY-r.top;o&&o!==s&&(e=b(i.element,s),i.containerDiffX=e.left,i.containerDiffY=e.top),i.left+=a,i.top+=l,i.gridX=i.left-i.containerDiffX,i.gridY=i.top-i.containerDiffY,y(i.element,{transform:"translateX("+i.left+"px) translateY("+i.top+"px)"}),n.dragSort&&i.checkOverlap(),this._muuri._emitter.emit(tt,this,I("dragscroll",t,i))},l.Item.prototype._onDragEnd=function(t){var e=this._drag,i=this._muuri._settings,n=this._release;return this._isActive?(i.dragSort&&e.checkOverlap("finish"),e.scrollParents.forEach(function(t){t.removeEventListener("scroll",e.onScroll)}),D(e.element,i.draggingClass),e.active=!1,this._muuri._emitter.emit(et,this,I("dragend",t,e)),n.item=e.item,n.containerDiffX=e.containerDiffX,n.containerDiffY=e.containerDiffY,n.element=e.element,n.elementStyles=e.elementStyles,this._resetDragData(),void this._startRelease()):void this._resetDrag()},l.Item.prototype._resetDrag=function(){var t=this._drag,e=this._muuri._settings;t.scrollParents.forEach(function(e){e.removeEventListener("scroll",t.onScroll)}),t.checkOverlap("cancel"),D(t.element,e.draggingClass),A(t),this._resetDragData()},l.Item.prototype._resetReleaseData=function(){var t=this._release;t.active=!1,t.item=null,t.positioningStarted=!1,t.containerDiffX=0,t.containerDiffY=0,t.element=null,t.elementStyles=null},l.Item.prototype._startRelease=function(){var t=this._muuri._settings,e=this._release;e.active=!0,w(e.element,t.releasingClass),this._muuri._emitter.emit(it,this),this._layout(!1)},l.Item.prototype._endRelease=function(){var t=this._muuri._settings,e=this._release;D(e.element,t.releasingClass),e.element.parentNode!==this._muuri._element&&(this._muuri._element.appendChild(e.element),y(e.element,{transform:"translateX("+this._left+"px) translateY("+this._top+"px)"})),A(e),this._resetReleaseData(),this._muuri._emitter.emit(nt,this)},l.Item.prototype._checkOverlap=function(){var t,e,i,n,s,o,r=this._muuri,a=r._dragSort(this);a&&(t=r._items,e=a.action||"move",i=a.from,n=a.to,s=t[i]._element,o=t[n]._element,"swap"===e?(h(t,i,n),r._emitter.emit(V,s,o)):(u(t,i,n),r._emitter.emit(U,s,o)),r.layout())},l.Item.prototype._stopLayout=function(){var t=this._muuri._settings;this._isPositioning&&(this._animate.stop(),D(this._element,t.positioningClass),this._isPositioning=!1,P(this._layoutQueue,!0,this))},l.Item.prototype._refresh=function(){this._isHidden||(this._width=Math.round(e.width(this._element,"margin")),this._height=Math.round(e.height(this._element,"margin")),this._margin={},["left","right","top","bottom"].forEach(function(t){this._margin[t]=Math.round(p(this._element,"margin-"+t))},this))},l.Item.prototype._layout=function(t,e){var i,n,s,o,r=this,a=r._muuri._settings,l=r._release,h=l.active&&l.positioningStarted===!1,u=h?a.dragReleaseDuration:a.layoutDuration,m=h?a.dragReleaseEasing:a.layoutEasing,c=t!==!0&&!r._noLayoutAnimation&&u>0,f=r._isPositioning,_=function(){D(r._element,a.positioningClass),r._isPositioning=!1,l.active&&r._endRelease(),P(r._layoutQueue,!1,r)};if(r._stopLayout(),"function"==typeof e&&r._layoutQueue.push(e),h&&(l.positioningStarted=!0),i=r._release.active?r._release.containerDiffX:0,n=r._release.active?r._release.containerDiffY:0,c){if(s=g(r._element,"x")-i,o=g(r._element,"y")-n,r._left===s&&r._top===o)return void _();r._isPositioning=!0,f||w(r._element,a.positioningClass),r._animate.start({transform:"translateX("+(r._left+i)+"px) translateY("+(r._top+n)+"px)"},{duration:u,easing:m,done:_})}else r._noLayoutAnimation&&(r._noLayoutAnimation=!1),y(r._element,{transform:"translateX("+(r._left+i)+"px) translateY("+(r._top+n)+"px)"}),_()},l.Item.prototype._show=function(t,e){var i=this,n=i._muuri._settings;i._isHidden||i._isShowing?i._isHidden?(i._muuri._itemHide.stop(i),i._isActive=!0,i._isHidden=!1,i._isShowing=i._isHiding=!1,w(i._element,n.shownClass),D(i._element,n.hiddenClass),y(i._element,{display:"block"}),P(i._visibilityQueue,!0,i),i._isShowing=!0,"function"==typeof e&&i._visibilityQueue.push(e),i._muuri._itemShow.start(i,t,function(){P(i._visibilityQueue,!1,i)})):"function"==typeof e&&i._visibilityQueue.push(e):"function"==typeof e&&e(!1,i)},l.Item.prototype._hide=function(t,e){var i=this,n=i._muuri._settings;i._isHidden&&!i._isHiding?"function"==typeof e&&e(!1,i):i._isHidden?"function"==typeof e&&i._visibilityQueue.push(e):(i._muuri._itemShow.stop(i),i._isActive=!1,i._isHidden=!0,i._isShowing=i._isHiding=!1,w(i._element,n.hiddenClass),D(i._element,n.shownClass),P(i._visibilityQueue,!0,i),i._isHiding=!0,"function"==typeof e&&i._visibilityQueue.push(e),i._muuri._itemHide.start(i,t,function(){y(i._element,{display:"none"}),P(i._visibilityQueue,!1,i)}))},l.Item.prototype._destroy=function(t){var e=this._muuri,i=e._settings,n=this._element,s=e._items.indexOf(this);this._stopLayout(),e._itemShow.stop(this),e._itemHide.stop(this),this._release.active&&(n.parentNode!==e._element&&e._element.appendChild(n),this._resetReleaseData()),this._drag.active&&(n.parentNode!==e._element&&e._element.appendChild(n),this._resetDrag()),this._hammer&&this._hammer.destroy(),this._animate.destroy(),this._animateChild.destroy(),n.removeAttribute("style"),this._child.removeAttribute("style"),P(this._visibilityQueue,!0,this),D(n,i.positioningClass),D(n,i.draggingClass),D(n,i.releasingClass),D(n,i.itemClass),D(n,i.shownClass),D(n,i.hiddenClass),s>-1&&e._items.splice(s,1),t&&n.parentNode.removeChild(n),Object.keys(this).concat(Object.keys(l.Item.prototype)).forEach(function(t){this[t]=null},this)},l.Layout=function(t,i){var n,s,o=t._settings.layout;if(this.muuri=t,this.items=i?i.concat():t.get("active"),this.slots={},this.width=0,this.height=0,this.setWidth=!1,this.setHeight=!1,this.width=e.width(t._element,"padding"),this.height=e.height(t._element,"padding"),"function"==typeof o)o.call(this);else{if(n="string"==typeof o,s=n?o:o[0],"function"!=typeof l.Layout.methods[s])throw new Error('Layout method "'+s+'" does not exist.');l.Layout.methods[s].call(this,n?{}:o[1])}},l.Layout.methods={firstFit:a},l.defaultSettings={container:null,items:[],show:{duration:300,easing:"ease",styles:{opacity:1,transform:"scale(1)"}},hide:{duration:300,easing:"ease",styles:{opacity:0,transform:"scale(0.5)"}},layout:"firstFit",layoutOnResize:100,layoutOnInit:!0,layoutDuration:300,layoutEasing:"ease",dragEnabled:!1,dragContainer:null,dragPredicate:null,dragSort:!0,dragSortInterval:50,dragSortPredicate:{tolerance:50,action:"move"},dragReleaseDuration:300,dragReleaseEasing:"ease",containerClass:"muuri",itemClass:"muuri-item",shownClass:"muuri-shown",hiddenClass:"muuri-hidden",positioningClass:"muuri-positioning",draggingClass:"muuri-dragging",releasingClass:"muuri-releasing"},l});