/*!
 * Muuri v0.3.0-dev
 * https://github.com/haltu/muuri
 * Copyright (c) 2015, Haltu Oy
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
!function(t,e){var i="Muuri",n=t.mezr,o="function"==typeof jQuery?jQuery.Velocity:t.Velocity,s=t.Hammer;t[i]=e(t,n,o,s)}(this,function(t,e,n,o,s){"use strict";function r(){}function a(t){var e=this,i=[],n=!!t.fillGaps,o=!!t.horizontal,s=!!t.alignRight,r=!!t.alignBottom;e.width=Math.round(e.width),e.height=Math.round(e.height),o?(e.setWidth=!0,e.width=0):(e.setHeight=!0,e.height=0),e.items.length&&(e.items.forEach(function(t){var s=a.getSlot(e,i,t._width,t._height,!o,n);o?e.width=Math.max(e.width,s.left+s.width):e.height=Math.max(e.height,s.top+s.height),e.slots[t._id]=s}),(s||r)&&Object.keys(e.slots).forEach(function(t){var i=e.slots[t];s&&(i.left=e.width-(i.left+i.width)),r&&(i.top=e.height-(i.top+i.height))}))}function h(e){var i,n=this,o=n._settings=m({},h.defaultSettings,e||{});if(!document.body.contains(o.container))throw new Error("Container must be an existing DOM element");n._element=o.container,w(o.container,o.containerClass),n._id=++H,n._animQueue="muuri-"+n._id,n._emitter=new r,n._itemShow="function"==typeof o.show?o.show():X("show",o.show),n._itemHide="function"==typeof o.hide?o.hide():X("hide",o.hide),n._dragSort="function"==typeof o.dragSortPredicate?o.dragSortPredicate:k,n._items=[].concat(o.items).map(function(t){return new h.Item(n,t)}),(o.layoutOnResize||0===o.layoutOnResize)&&(i=_(function(){n.refresh(),n.layout()},o.layoutOnResize),n._resizeHandler=function(){i()},t.addEventListener("resize",n._resizeHandler)),o.layoutOnInit&&n.layout(!0)}function l(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function u(t,e,i){t.splice(i,0,t.splice(e,1)[0])}function c(t){var e=[];return t.forEach(function(t){e.indexOf(t)<0&&e.push(t)}),e}function f(t){return"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)}function m(t){var e,i=arguments.length;for(e=1;e<i;e++)Object.keys(arguments[e]).forEach(function(e){"styles"!==e&&f(t[e])&&f(this[e])?m(t[e],this[e]):t[e]=this[e]},arguments[e]);return t}function _(e,i){var n,o="cancel",r="finish";return function(a){n!==s&&(n=t.clearTimeout(n),a===r&&e()),a!==o&&a!==r&&(n=t.setTimeout(function(){n=s,e()},i))}}function d(e,i){return t.getComputedStyle(e,null).getPropertyValue(i)}function p(t,e){return parseFloat(d(t,e))||0}function g(t,e){Object.keys(e).forEach(function(i){t.style[i]=e[i]})}function y(t,e){Object.keys(e).forEach(function(i){n.hook(t,i,e[i])})}function v(t,e){return(" "+t.className).indexOf(" "+e)>-1}function w(t,e){t.classList?t.classList.add(e):v(t,e)&&(t.className+=" "+e)}function D(t,e){t.classList?t.classList.remove(e):v(t,e)&&(t.className=(" "+t.className+" ").replace(" "+e+" "," ").trim())}function C(t){var i=d(t,e._settings.transform.styleName),n=d(t,"display");return"none"!==i&&"inline"!==n&&"none"!==n}function S(t,i){return e.offset([i,"padding"],[e.containingBlock(t)||document,"padding"])}function E(i){var n=[],o=/(auto|scroll)/,s=i.parentNode;if(e._settings.transformLeaksFixed){if("fixed"===d(i,"position"))return n;for(;s&&s!==document&&s!==document.documentElement;)o.test(d(s,"overflow")+d(s,"overflow-y")+d(s,"overflow-x"))&&n.push(s),s="fixed"===d(s,"position")?null:s.parentNode;null!==s&&n.push(t)}else{for(;s&&s!==document;)"fixed"!==d(i,"position")||C(s)?(o.test(d(s,"overflow")+d(s,"overflow-y")+d(s,"overflow-x"))&&n.push(s),i=s,s=s.parentNode):s=s.parentNode;n.length&&n[n.length-1]===document.documentElement&&(n[n.length-1]=t)}return n}function b(t,i){var n={intersection:e.intersection(t,i),score:0};if(!n.intersection)return n;var o={width:t.width,height:t.height,left:0,top:0},s={width:i.width,height:i.height,left:0,top:0},r=e.intersection(o,s);return n.score=n.intersection.width*n.intersection.height/(r.width*r.height)*100,n}function I(t,e,i){return{type:t,event:e,currentLeft:i.left,currentTop:i.top,gridLeft:i.gridX,gridTop:i.gridY}}function R(t,e,i){this.isResolved||(this.isResolved=!0,i(t))}function O(t){t.elementStyles||(t.elementStyles={},["width","height","padding","margin"].forEach(function(e){t.elementStyles[e]=t.element.style[e]||"",t.element.style[e]=d(t.element,e)}))}function x(t){t.elementStyles&&Object.keys(t).forEach(function(e){t.element.style[e]=t.elementStyles[e]})}function L(t,e,i,n,o){var s,r,a=t.get(i),h="function"==typeof n?n:o,l=a.length,u="show"===e,c=u?M:q,f=u?F:T,m=n===!0,_=!1;l?(s=[],r=[],t._emitter.emit(c,a),a.forEach(function(i){(u&&!i._isActive||!u&&i._isActive)&&(_=!0,u&&(i._noLayoutAnimation=!0,r.push(i))),i["_"+e](m,function(e,i){e||s.push(i),--l<1&&("function"==typeof h&&h(s),t._emitter.emit(f,s))})}),_&&(r.length&&t.refresh(r),t.layout())):"function"==typeof o&&o(a)}function X(t,e){var i=parseInt(e&&e.duration)||0,o=i>0,s=e&&e.easing||"ease-out",r=e&&f(e.styles)?e.styles:null;return{styles:r,start:function(t,e,a){o&&r?e?(y(t._child,r),a()):(n(t._child,r,{duration:i,easing:s,queue:t._muuri._animQueue,complete:a}),n.Utilities.dequeue(t._child,t._muuri._animQueue)):a()},stop:function(t){n(t._child,"stop",t._muuri._animQueue)}}}function Y(t,e,i){t.splice(0,t.length).forEach(function(t){t(e,i)})}function k(t){var e,i=t._muuri,n=i._settings,o=n.dragSortPredicate||{},s=o.tolerance||50,r=o.action||"move",a=i._items,h=t._drag,l={width:h.item._width-h.item._margin.left-h.item._margin.right,height:h.item._height-h.item._margin.top-h.item._margin.bottom,left:h.gridX+h.item._margin.left,top:h.gridY+h.item._margin.top},u=0,c=null;return a.forEach(function(i,n){var o,s;i===t?u=n:i._isActive&&(o={width:i._width-i._margin.left-i._margin.right,height:i._height-i._margin.top-i._margin.bottom,left:i._left+i._margin.left,top:i._top+i._margin.top},s=b(l,o),(null===c||s.score>c)&&(c=s.score,e=n))}),null!==c&&c>=s&&{action:r,from:u,to:e}}var P="Muuri";if(!e)throw Error("["+P+"] required dependency mezr is not defined.");if(!n)throw Error("["+P+"] required dependency Velocity is not defined.");var H=0,A=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||t.oRequestAnimationFrame||null,Q="refresh",N="synchronize",j="layoutstart",z="layoutend",M="showstart",F="showend",q="hidestart",T="hideend",W="move",B="swap",V="add",U="remove",G="dragstart",J="dragmove",K="dragscroll",Z="dragend",$="releasestart",tt="releaseend",et="destroy";return r.prototype.on=function(t,e){var i=this._events=this._events||{},n=i[t]||[];return n.push(e),i[t]=n,this},r.prototype.off=function(t,e){var n=this._events=this._events||{},o=n[t]||[],s=o.length;if(s)for(;s--;)e===o[i]&&o.splice(s,1);return this},r.prototype.emit=function(t,e,i,n){var o,s,r=this._events=this._events||{},a=r[t]||[],h=a.length;if(h)for(o=arguments.length-1,a=a.concat(),s=0;s<h;s++)0===o?a[s]():1===o?a[s](e):2===o?a[s](e,i):a[s](e,i,n);return this},a.getSlot=function(t,e,i,n,o,s){var r,h,l,u,c,f=e[0]||[],m=[],_={left:null,top:null,width:i,height:n};for(r=0;r<f.length;r++)if(l=f[r],_.width<=l.width&&_.height<=l.height){_.left=l.left,_.top=l.top;break}for(null===_.left&&(_.left=o?0:t.width,_.top=o?t.height:0,s||(c=!0)),o&&_.top+_.height>t.height&&(_.left>0&&m.push({left:0,top:t.height,width:_.left,height:1/0}),_.left+_.width<t.width&&m.push({left:_.left+_.width,top:t.height,width:t.width-_.left-_.width,height:1/0}),t.height=_.top+_.height),!o&&_.left+_.width>t.width&&(_.top>0&&m.push({left:t.width,top:0,width:1/0,height:_.top}),_.top+_.height<t.height&&m.push({left:t.width,top:_.top+_.height,width:1/0,height:t.height-_.top-_.height}),t.width=_.left+_.width),r=s?0:c?f.length:r;r<f.length;r++)for(u=a.splitRect(f[r],_),h=0;h<u.length;h++)l=u[h],l.width>0&&l.height>0&&(o&&l.top<t.height||!o&&l.left<t.width)&&m.push(l);return a.purgeSlots(m).sort(o?a.sortRectsTopLeft:a.sortRectsLeftTop),e[0]=m,_},a.sortRectsTopLeft=function(t,e){return t.top<e.top?-1:t.top>e.top?1:t.left<e.left?-1:t.left>e.left?1:0},a.sortRectsLeftTop=function(t,e){return t.left<e.left?-1:t.left>e.left?1:t.top<e.top?-1:t.top>e.top?1:0},a.isRectWithinRect=function(t,e){return t.left>=e.left&&t.top>=e.top&&t.left+t.width<=e.left+e.width&&t.top+t.height<=e.top+e.height},a.purgeSlots=function(t){for(var e,i,n,o=t.length;o--;)for(i=t[o],e=t.length;e--;)if(n=t[e],o!==e&&a.isRectWithinRect(i,n)){t.splice(o,1);break}return t},a.splitRect=function(t,e){var i=[],n=!(e.left>t.left+t.width||e.left+e.width<t.left||e.top>t.top+t.height||e.top+e.height<t.top);return n?(t.left<e.left&&i.push({left:t.left,top:t.top,width:e.left-t.left,height:t.height}),t.left+t.width>e.left+e.width&&i.push({left:e.left+e.width,top:t.top,width:t.left+t.width-(e.left+e.width),height:t.height}),t.top<e.top&&i.push({left:t.left,top:t.top,width:t.width,height:e.top-t.top}),t.top+t.height>e.top+e.height&&i.push({left:t.left,top:e.top+e.height,width:t.width,height:t.top+t.height-(e.top+e.height)})):i[0]=t,i},h.prototype._getItem=function(t){var e,i,n,o;if(t){if(t instanceof h.Item)return t._muuri===this?t:null;if("number"==typeof t)return e=t>-1?t:this._items.length+t,this._items[e]||null;for(i=null,o=0;o<this._items.length;o++)if(n=this._items[o],n._element===t){i=n;break}return i}return this._items[0]||null},h.prototype.on=function(t,e){return this._emitter.on(t,e),this},h.prototype.off=function(t,e){return this._emitter.off(t,e),this},h.prototype.refresh=function(t){var e=this.get(t||"active");e.forEach(function(t){t._refresh()}),this._emitter.emit(Q,e)},h.prototype.get=function(t,e){var i=t&&"string"!=typeof t,n=i?[].concat(t):null,o=i?e:t,s=[];return o="string"==typeof o?o:null,o||n?((n||this._items).forEach(function(t){var e=i?this._getItem(t):t;e&&(!o||"active"===o&&e._isActive||"inactive"===o&&!e._isActive)&&s.push(e)},this),s):s.concat(this._items)},h.prototype.add=function(t,e){var i=[],n=!1;return t=[].concat(t),this._items.forEach(function(e){var i=t.indexOf(e._element);i>-1&&t.splice(i,1)}),t.length?(t.forEach(function(t){var e=new h.Item(this,t);i.push(e),e._isActive&&(n=!0,e._noLayoutAnimation=!0)},this),e="number"==typeof e?e:-1,e=e<0?this._items.length-e+1:e,this._items.splice.apply(this._items,[e,0].concat(i)),n&&this.layout(),this._emitter.emit(V,i),i):i},h.prototype.remove=function(t,e){var i=[],n=!1;return this.get(t).forEach(function(t){t._isActive&&(n=!0),i.push(t._destroy(e))}),n&&this.layout(),this._emitter.emit(U,i),i},h.prototype.synchronize=function(){this._items.forEach(function(t){t._element.parentNode===this._element&&this._element.appendChild(t._element)},this),this._emitter.emit(N)},h.prototype.layout=function(t,e){var i=this,n=i._emitter,o="function"==typeof t?t:e,s=t===!0,r=new h.Layout(i),a=-1,l=r.items.length,u=[],c=function(t,e){t||u.push(e),++a===l&&("function"==typeof o&&o(u,r),n.emit(z,u,r))};n.emit(j,r.items,r),r.setHeight&&g(i._element,{height:r.height+"px"}),r.setWidth&&g(i._element,{width:r.width+"px"}),l?r.items.forEach(function(t){var e=r.slots[t._id];t._left=e.left,t._top=e.top,t._drag.active?c(!1,t):t._layout(s,c)}):c(!0)},h.prototype.show=function(t,e,i){L(this,"show",t,e,i)},h.prototype.hide=function(t,e,i){L(this,"hide",t,e,i)},h.prototype.indexOf=function(t){var e,i;if("number"==typeof t)return t<=this._items.length-1?t:-1;if(t instanceof h.Item)return this._items.indexOf(t);for(e=0,i=this._items.length;e<i;e++)if(this._items[e]._element===t)return e;return-1},h.prototype.move=function(t,e){t=this._getItem(t),e=this._getItem(e),t&&e&&t!==e&&(u(this._items,this._items.indexOf(t),this._items.indexOf(e)),this._emitter.emit(W,t,e))},h.prototype.swap=function(t,e){t=this._getItem(t),e=this._getItem(e),t&&e&&t!==e&&(l(this._items,this._items.indexOf(t),this._items.indexOf(e)),this._emitter.emit(B,t,e))},h.prototype.destroy=function(){this._resizeHandler&&t.removeEventListener("resize",this._resizeHandler),this._items.concat().forEach(function(t){t._destroy()}),D(this._element,this._settings.containerClass),g(this._element,{height:""}),this._emitter.emit(et),this._emitter._events&&Object.keys(this._emitter._events).forEach(function(t){this._emitter._events[t].length=0},this),Object.keys(this).concat(Object.keys(h.prototype)).forEach(function(t){this[t]=null},this)},h.Item=function(t,e){var i,n,o=t._settings;if(e.contains(t._element))throw new Error("Item element must not be a parent of the grid container element");e.parentNode!==t._element&&t._element.appendChild(e),i="none"===d(e,"display"),this._id=++H,this._muuri=t,this._element=e,this._child=e.children[0],w(e,o.itemClass),this._isActive=!i,this._isPositioning=!1,this._isHidden=i,this._isHiding=!1,this._isShowing=!1,this._visibilityQueue=[],this._layoutQueue=[],y(this._element,{left:"0",top:"0",translateX:"0px",translateY:"0px"}),w(e,i?o.hiddenClass:o.shownClass),n=t[i?"_itemHide":"_itemShow"].styles,n&&y(this._child,n),i||g(this._element,{display:"block"}),this._refresh(),this._left=0,this._top=0,this._drag={active:!1},this._release={active:!1},t._settings.dragEnabled&&this._initDrag()},h.Item.prototype.inspect=function(){return{element:this._element,width:this._width,height:this._height,margin:{left:this._margin.left,top:this._margin.top,right:this._margin.right,bottom:this._margin.bottom},left:this._left,top:this._top,active:this._isActive,positioning:this._isPositioning,dragging:this._drag.active,releasing:this._release.active,visibility:this._isHiding?"hiding":this._isShowing?"showing":this._isHidden?"hidden":"shown"}},h.Item.prototype._initDrag=function(){if(!o)throw Error("["+P+"] required dependency Hammer is not defined.");var t=this,e=t._muuri._settings,i=t._drag,n=!1,s=t._hammer=new o.Manager(t._element);s.add(new o.Pan({event:"drag",pointers:1,threshold:0,direction:o.DIRECTION_ALL})),s.add(new o.Press({event:"draginit",pointers:1,threshold:100,time:0})),s.set({touchAction:"none"}),t._resetReleaseData(),t._resetDragData(),i.checkOverlap=_(function(){i.active&&t._checkOverlap()},e.dragSortInterval),i.predicate="function"==typeof e.dragPredicate?e.dragPredicate:R,i.predicateData={},i.isPredicateResolved=function(){return n},i.resolvePredicate=function(e){n||"draginitup"===e.type||"dragend"===e.type||"dragcancel"===e.type||(n=!0,t._onDragStart(e))},i.onScroll=function(e){A?A(function(){t._onDragScroll(e)}):t._onDragScroll(e)},s.on("draginit",function(e){i.predicateData={},n=!1,i.predicate.call(i.predicateData,e,t,i.resolvePredicate)}).on("dragstart dragmove",function(e){n&&i.active&&t._onDragMove(e),i.predicate.call(i.predicateData,e,t,i.resolvePredicate)}).on("dragend dragcancel draginitup",function(e){n&&i.active&&t._onDragEnd(e),i.predicate.call(i.predicateData,e,t,i.resolvePredicate)})},h.Item.prototype._resetDragData=function(){var t=this._drag;t.active=!1,t.start=null,t.lastMove=null,t.move=null,t.item=null,t.element=null,t.elementStyles=null,t.scrollParents=[],t.left=0,t.top=0,t.gridX=0,t.gridY=0,t.elemClientX=0,t.elemClientY=0,t.containerDiffX=0,t.containerDiffY=0},h.Item.prototype._onDragStart=function(t){var e,i,o,s,r,a,h=this._drag,l=this._muuri._settings,u=this._release.active;this._isActive&&(this._isPositioning&&this._stopLayout(),u&&(h.elementStyles=this._release.elementStyles,D(this._element,l.releasingClass),this._resetReleaseData()),h.active=!0,h.start=t,h.lastMove=t,h.move=t,h.item=this,h.element=this._element,e=parseFloat(n.hook(h.element,"translateX"))||0,i=parseFloat(n.hook(h.element,"translateY"))||0,o=this._muuri._element,s=l.dragContainer,h.left=h.gridX=e,h.top=h.gridY=i,s&&s!==o&&(h.element.parentNode===s?(r=S(h.element,o),h.containerDiffX=r.left,h.containerDiffY=r.top,h.gridX=e-h.containerDiffX,h.gridY=i-h.containerDiffY):(O(h),s.appendChild(h.element),r=S(h.element,o),h.containerDiffX=r.left,h.containerDiffY=r.top,h.left=e+h.containerDiffX,h.top=i+h.containerDiffY,y(h.element,{translateX:h.left+"px",translateY:h.top+"px"}))),a=h.element.getBoundingClientRect(),h.elemClientX=a.left,h.elemClientY=a.top,h.scrollParents=E(h.element),s&&s!==o&&(h.scrollParents=c(h.scrollParents.concat(E(o)))),h.scrollParents.forEach(function(t){t.addEventListener("scroll",h.onScroll)}),w(h.element,l.draggingClass),this._muuri._emitter.emit(G,this,I("dragstart",t,h)))},h.Item.prototype._onDragMove=function(t){var e,i,n=this._drag,o=this._muuri._settings;return this._isActive?(e=t.deltaX-n.move.deltaX,i=t.deltaY-n.move.deltaY,n.lastMove=n.move,n.move=t,n.left+=e,n.top+=i,n.gridX+=e,n.gridY+=i,n.elemClientX+=e,n.elemClientY+=i,y(n.element,{translateX:n.left+"px",translateY:n.top+"px"}),o.dragSort&&n.checkOverlap(),void this._muuri._emitter.emit(J,this,I("dragmove",t,n))):void this._resetDrag()},h.Item.prototype._onDragScroll=function(t){var e,i=this._drag,n=this._muuri._settings,o=this._muuri._element,s=n.dragContainer,r=i.element.getBoundingClientRect(),a=i.elemClientX-r.left,h=i.elemClientY-r.top;s&&s!==o&&(e=S(i.element,o),i.containerDiffX=e.left,i.containerDiffY=e.top),i.left+=a,i.top+=h,i.gridX=i.left-i.containerDiffX,i.gridY=i.top-i.containerDiffY,y(i.element,{translateX:i.left+"px",translateY:i.top+"px"}),n.dragSort&&i.checkOverlap(),this._muuri._emitter.emit(K,this,I("dragscroll",t,i))},h.Item.prototype._onDragEnd=function(t){var e=this._drag,i=this._muuri._settings,n=this._release;return this._isActive?(i.dragSort&&e.checkOverlap("finish"),e.scrollParents.forEach(function(t){t.removeEventListener("scroll",e.onScroll)}),D(e.element,i.draggingClass),e.active=!1,this._muuri._emitter.emit(Z,this,I("dragend",t,e)),n.item=e.item,n.containerDiffX=e.containerDiffX,n.containerDiffY=e.containerDiffY,n.element=e.element,n.elementStyles=e.elementStyles,this._resetDragData(),void this._startRelease()):void this._resetDrag()},h.Item.prototype._resetDrag=function(){var t=this._drag,e=this._muuri._settings;t.scrollParents.forEach(function(e){e.removeEventListener("scroll",t.onScroll)}),t.checkOverlap("cancel"),D(t.element,e.draggingClass),x(t),this._resetDragData()},h.Item.prototype._resetReleaseData=function(){var t=this._release;t.active=!1,t.item=null,t.positioningStarted=!1,t.containerDiffX=0,t.containerDiffY=0,t.element=null,t.elementStyles=null},h.Item.prototype._startRelease=function(){var t=this._muuri._settings,e=this._release;e.active=!0,w(e.element,t.releasingClass),this._muuri._emitter.emit($,this),this._layout(!1)},h.Item.prototype._endRelease=function(){var t=this._muuri._settings,e=this._release;D(e.element,t.releasingClass),e.element.parentNode!==this._muuri._element&&(this._muuri._element.appendChild(e.element),y(e.element,{translateX:this._left+"px",translateY:this._top+"px"})),x(e),this._resetReleaseData(),this._muuri._emitter.emit(tt,this)},h.Item.prototype._checkOverlap=function(){var t,e,i,n,o,s,r=this._muuri,a=r._dragSort(this);a&&(t=r._items,e=a.action||"move",i=a.from,n=a.to,o=t[i]._element,s=t[n]._element,"swap"===e?(l(t,i,n),r._emitter.emit(B,o,s)):(u(t,i,n),r._emitter.emit(W,o,s)),r.layout())},h.Item.prototype._stopLayout=function(){var t=this._muuri._settings;this._isPositioning&&(n(this._element,"stop",this._muuri._animQueue),D(this._element,t.positioningClass),this._isPositioning=!1,Y(this._layoutQueue,!0,this))},h.Item.prototype._refresh=function(){this._isHidden||(this._width=Math.round(e.width(this._element,"margin")),this._height=Math.round(e.height(this._element,"margin")),this._margin={},["left","right","top","bottom"].forEach(function(t){this._margin[t]=Math.round(p(this._element,"margin-"+t))},this))},h.Item.prototype._layout=function(t,e){var i,o,s,r,a=this,h=a._muuri._settings,l=a._release,u=l.active&&l.positioningStarted===!1,c=u?h.dragReleaseDuration:h.layoutDuration,f=u?h.dragReleaseEasing:h.layoutEasing,m=t!==!0&&!a._noLayoutAnimation&&c>0,_=a._isPositioning,d=function(){D(a._element,h.positioningClass),a._isPositioning=!1,l.active&&a._endRelease(),Y(a._layoutQueue,!1,a)};if(a._stopLayout(),"function"==typeof e&&a._layoutQueue.push(e),u&&(l.positioningStarted=!0),i=a._release.active?a._release.containerDiffX:0,o=a._release.active?a._release.containerDiffY:0,m){if(s=(parseFloat(n.hook(a._element,"translateX"))||0)-i,r=(parseFloat(n.hook(a._element,"translateY"))||0)-o,a._left===s&&a._top===r)return void d();a._isPositioning=!0,_||w(a._element,h.positioningClass),n(a._element,{translateX:a._left+i,translateY:a._top+o},{duration:c,easing:f,complete:d,queue:a._muuri._animQueue}),n.Utilities.dequeue(a._element,a._muuri._animQueue)}else a._noLayoutAnimation&&(a._noLayoutAnimation=!1),y(a._element,{translateX:a._left+i+"px",translateY:a._top+o+"px"}),d()},h.Item.prototype._show=function(t,e){var i=this,n=i._muuri._settings;i._isHidden||i._isShowing?i._isHidden?(i._muuri._itemHide.stop(i),i._isActive=!0,i._isHidden=!1,i._isShowing=i._isHiding=!1,w(i._element,n.shownClass),D(i._element,n.hiddenClass),g(i._element,{display:"block"}),Y(i._visibilityQueue,!0,i),i._isShowing=!0,"function"==typeof e&&i._visibilityQueue.push(e),i._muuri._itemShow.start(i,t,function(){Y(i._visibilityQueue,!1,i)})):"function"==typeof e&&i._visibilityQueue.push(e):"function"==typeof e&&e(!1,i)},h.Item.prototype._hide=function(t,e){var i=this,n=i._muuri._settings;i._isHidden&&!i._isHiding?"function"==typeof e&&e(!1,i):i._isHidden?"function"==typeof e&&i._visibilityQueue.push(e):(i._muuri._itemShow.stop(i),i._isActive=!1,i._isHidden=!0,i._isShowing=i._isHiding=!1,w(i._element,n.hiddenClass),D(i._element,n.shownClass),Y(i._visibilityQueue,!0,i),i._isHiding=!0,"function"==typeof e&&i._visibilityQueue.push(e),i._muuri._itemHide.start(i,t,function(){g(i._element,{display:"none"}),Y(i._visibilityQueue,!1,i)}))},h.Item.prototype._destroy=function(t){var e=this._muuri,i=e._settings,n=this._element,o=e._items.indexOf(this);this._stopLayout(),e._itemShow.stop(this),e._itemHide.stop(this),this._release.active&&(n.parentNode!==e._element&&e._element.appendChild(n),this._resetReleaseData()),this._drag.active&&(n.parentNode!==e._element&&e._element.appendChild(n),this._resetDrag()),this._hammer&&this._hammer.destroy(),n.removeAttribute("style"),this._child.removeAttribute("style"),Y(this._visibilityQueue,!0,this),D(n,i.positioningClass),D(n,i.draggingClass),D(n,i.releasingClass),D(n,i.itemClass),D(n,i.shownClass),D(n,i.hiddenClass),o>-1&&e._items.splice(o,1),t&&n.parentNode.removeChild(n),Object.keys(this).concat(Object.keys(h.Item.prototype)).forEach(function(t){this[t]=null},this)},h.Layout=function(t,i){var n,o,s=t._settings.layout;if(this.muuri=t,this.items=i?i.concat():t.get("active"),this.slots={},this.width=0,this.height=0,this.setWidth=!1,this.setHeight=!1,this.width=e.width(t._element,"padding"),this.height=e.height(t._element,"padding"),"function"==typeof s)s.call(this);else{if(n="string"==typeof s,o=n?s:s[0],"function"!=typeof h.Layout.methods[o])throw new Error('Layout method "'+o+'" does not exist.');h.Layout.methods[o].call(this,n?{}:s[1])}},h.Layout.methods={firstFit:a},h.defaultSettings={container:null,items:[],show:{duration:300,easing:"ease-out",styles:{scale:1,opacity:1}},hide:{duration:300,easing:"ease-out",styles:{scale:.5,opacity:0}},layout:"firstFit",layoutOnResize:100,layoutOnInit:!0,layoutDuration:300,layoutEasing:"ease-out",dragEnabled:!1,dragContainer:null,dragPredicate:null,dragSort:!0,dragSortInterval:50,dragSortPredicate:{tolerance:50,action:"move"},dragReleaseDuration:300,dragReleaseEasing:"ease-out",containerClass:"muuri",itemClass:"muuri-item",shownClass:"muuri-shown",hiddenClass:"muuri-hidden",positioningClass:"muuri-positioning",draggingClass:"muuri-dragging",releasingClass:"muuri-releasing"},h});